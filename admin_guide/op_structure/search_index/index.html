<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Search Index &#8212; OroCommerce 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Elasticsearch" href="elastic_search.html" />
    <link rel="prev" title="Operational Structure" href="../index.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
<div class="header">
    <div class="main-nav">
        <nav class="navbar navbar-default navbar-fixed-top">
            <div id="nav-menu" class="navbar-top">
                <div class="nav-container">
                    <div class="navbar-header">
                        <a href="https://www.orocommerce.com/"
                           class="navbar-brand"><img
                                src="https://www.orocommerce.com/wp-content/themes/commerce/images/orocommerce_logo.svg"
                                alt="Open Source B2B eCommerce Platform - OroCommerce"></a>
                    </div>
                    <div class="navbar-header">
                        <p class="navbar-header" href="#">Documentation</p>
                    </div>
                    <div class="navbar-right">
                        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="elastic_search.html" title="Elasticsearch"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../index.html" title="Operational Structure"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Administrator Guide</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" accesskey="U">Operational Structure</a> &#187;</li> 
     <li class="nav-item nav-item-this">Search Index</li>
      </ul>
    </div>
                    </div>

                </div>
            </div>

        </nav>
    </div>
</div>


      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="search-index">
<h1>Search Index<a class="headerlink" href="#search-index" title="Permalink to this headline">¶</a></h1>
<div class="section" id="responsibility">
<h2>Responsibility<a class="headerlink" href="#responsibility" title="Permalink to this headline">¶</a></h2>
<p>Search Index component is responsible for interaction with the separate search engine and search index storage inside it. Search engine can:</p>
<ul class="simple">
<li>perform search quickly (in comparison with standard ORM search)</li>
<li>apply complicated filters to results</li>
<li>sort search results by relevancy or specific field</li>
<li>extract additional data from search index</li>
<li>calculate aggregated values</li>
</ul>
</div>
<div class="section" id="main-concepts">
<h2>Main Concepts<a class="headerlink" href="#main-concepts" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Search_engine_(computing)">Search engine</a> is the specialized software that provides ability to store data, index data and perform quick and relevant search. The biggest difference between the search engine and a conventional data storage is the fact that search engine performs search significantly faster, and can do <a class="reference external" href="https://en.wikipedia.org/wiki/Full-text_search">overall full-text search</a> in addition to search by the specific area. Examples of search engines - <a class="reference external" href="https://en.wikipedia.org/wiki/Elasticsearch">Elasticsearch</a>, <a class="reference external" href="https://en.wikipedia.org/wiki/Apache_Lucene">Lucene</a>, <a class="reference external" href="https://en.wikipedia.org/wiki/Apache_Solr">Solr</a>. To use an analogy to relational databases, search engine is similar to Database Management System (DBMS).
<strong>Search index</strong> (sometimes referred as just index) is an actual storage where specific scope of search data is stored. One search engine may work with several indexes. Search index is structured, i.e. provides ability to organize data in the complex multilevel structures; minimal amount of levels required to work with Oro application is two. Search index can validate data type of the data stored inside. Search index is a document based storage where each document represents one specific entity from the main relational database. Search index can be considered as a specialized reflection of the main relational database. To use an analogy to relational databases, search index is similar to database (DB).
<strong>Entity alias</strong> is a text representation of entity name stored inside the specific search index. Entity alias represents first level of search index structure. To use an analogy to relational databases, entity alias is similar to a table name.
<strong>Entity field</strong> is a text representation of entity property name assigned to a specific entity alias. Entity alias represents second level of search index structure. Entity field has assigned data type (text, integer, decimal, datetime) and search engine uses this information to validate data stored inside the index. To use an analogy to relational databases, entity field is similar to a column name.
<strong>Entity field value</strong> is an actual value of an entity property assigned to a specific entity field. To use an analogy to relational databases, entity field value is similar to a value of a column.
<strong>All-text field</strong> is a special entity field used to do overall full-text search. Value of this field is usually calculated automatically based on the text entity field values.
<strong>Search document</strong> is a combination of entity fields and entity field values and represents data of one specific entity from the main relational database. Search document has plain structure - i.e. field values must not contain other documents. To use an analogy to relational databases, search document is similar to a table row.
<strong>Indexation</strong> is a process of updating of a data in a search index - it might be extraction of the required data from an entities and saving it to search index, or removing of required documents from search index.
<strong>Search mapping</strong> is a combination of entity aliases and entity field definitions. To use an analogy to relational databases, search mapping is similar to a database schema.
<strong>Search placeholder</strong> is a variable part of entity alias or entity field which can be substituted with an actual value during the indexation or performing a search request.</p>
<p>Following diagram shows described structure:</p>
<img alt="../../../_images/op_search_diag.png" src="../../../_images/op_search_diag.png" />
</div>
<div class="section" id="index-types">
<h2>Index Types<a class="headerlink" href="#index-types" title="Permalink to this headline">¶</a></h2>
<p>Oro applications use two typed of indexes which are using common interfaces.</p>
<div class="section" id="common-interfaces">
<h3>Common Interfaces<a class="headerlink" href="#common-interfaces" title="Permalink to this headline">¶</a></h3>
<p>Common interfaces are used at all index types to provide high level abstraction for a functionality that has to work with any type of search index (e.g. datagrids).
<strong>Search engine interface</strong> OroBundleSearchBundleEngineEngineInterface is used to perform search requests to a search index.
<strong>Search indexer interface</strong> OroBundleSearchBundleEngineIndexerInterface is used for indexation, i.e. to change state of a search index (save data, remove data, reset index).</p>
</div>
<div class="section" id="standard-index-type">
<h3>Standard Index Type<a class="headerlink" href="#standard-index-type" title="Permalink to this headline">¶</a></h3>
<p>Standard index type (sometimes referred as default index type or backend index type) is used at all applications based on OroPlatform. Each entity is represented by one plain entity alias, contains plain field names to represent data assigned directly to main entity or data from the related entities.</p>
<p>Standard index type triggers following events:</p>
<ul class="simple">
<li>oro_search.mapping_config - during the mapping collection process, used to alter mapping information;</li>
<li>oro_search.prepare_entity_map - during the indexation process, triggered for each entity, used to change data stored inside the index;</li>
<li>oro_search.before_search - before the search request, used to change search request before its execution;</li>
<li>oro_search.prepare_result_item - after the extraction of documents from search index, used to populate addional information (entitiy objects, URLs etc).</li>
</ul>
<p>Standard index type performs indexation on an entity level - i.e. indexation process is triggered for each entity. Search field values can be calculated automatically based on the defined search mapping. Each search document contains one all-text field value calculated automatically as a concatenation of all text entity field values. Each field might have several values - in this case it will be represented as an array, and comparison operations will iterate over all of them. During the reindexation entities that are being reindexing are not available for search.</p>
<p>Search mapping can be stored inside any bundle at the file Resources/config/oro/search.yml. Engine-specific services have to be defined at file Resources/config/oro/search_engine/&lt;engine&gt;.yml. Main logic of this index type is stored inside the OroSearchBundle at platform package.</p>
</div>
<div class="section" id="website-index-type">
<h3>Website Index Type<a class="headerlink" href="#website-index-type" title="Permalink to this headline">¶</a></h3>
<p>Website index type (sometimes referred as frontend index type) is used only at the OroCommerce application - this application uses standard index type at backend part, and website index type at frontent part of the application. Each entity is represented by one alias wtih optional search placeholder (e.g. oro_product_WEBSITE_IT), so in fact each website might have it&#8217;s own entity alias (e.g. oro_product_1 and oro_product_2). Entity fields might contain search placeholders as well (e.g. name_LOCALIZATION_ID), so in fact each field might have several values depending on the provided placeholders (e.g. name_1, name_2 and name_3).</p>
<p>Website index type triggers following events:</p>
<ul class="simple">
<li>oro_website_search.reindexation_request - triggers reindexation process for the specified scope of entities, here are examples of a triggering of this event;</li>
<li>oro_website_search.event.website_search_mapping.configuration - during the mapping collection process, used to alter mapping information;</li>
<li>oro_website_search.event.collect_context - before the indexation, used to collect context which will be used during the indexation;</li>
<li>oro_website_search.event.restrict_index_entity - during the indexation for all entities, used to decrease amount of entities that has to be indexed;</li>
<li>oro_website_search.event.restrict_index_entity.&lt;alias&gt; - during the indexation for the specific entity, used to decrease amount of specific entities that has to be indexed (pay attention that &lt;alias&gt; is a standard entity alias, not search entity alias);</li>
<li>oro_website_search.event.index_entity - during the indexation fro all entities, used to collect data to put into search index, here is example of a listener for this event;</li>
<li>oro_website_search.event.index_entity.&lt;alias&gt; - during the indexation for the specific entity, used to collect data for a specific entity to put into search index (pay attention that &lt;alias&gt; is a standard entity alias, not search entity alias);</li>
<li>oro_website_search.before_search - before the search request, used to change search request before its execution.</li>
</ul>
<p>Website index type performs reindexation on an entity batch level - i.e. indexation process is triggered for batch of entities (default batch size is 100). Search field values have to be calculated and set manually at a listener to oro_website_search.event.index_entity event. Each search document contains all-text fields for each available localization (all_text_LOCALIZATION_ID) and one all-text field that includes values from all localizations, values are calculated automatically based on a flag set during the indexation (i.e. developer may specify what exact values should be in all-text field value). Each field without placeholder must have ony one value. During the reindexation entities that are being reindexing are available with the old (outdated) data.</p>
<p>Placeholders are defined in code in a classes that implements OroBundleWebsiteSearchBundlePlaceholderPlaceholderInterface. Here are the most commonly used placeholders (pay attention that there are more of them in a code):</p>
<ul class="simple">
<li>WEBSITE_ID - integer identifier of a current website</li>
<li>LOCALIZATION_ID - integer identifier of a current localization</li>
<li>CUSTOMER_ID - integer identifier of a current customer user</li>
<li>CURRENCY - string identifier of a current currency</li>
<li>CPL_ID - integer identifier of a current combined price list</li>
</ul>
<p>Search mapping can be stored inside any bundle at the file Resources/config/oro/website_search.yml. Engine-specific services have to be defined at file Resources/config/oro/website_search_engine/&lt;engine&gt;.yml. Main logic of this index type is stored inside the OroWebsiteSearchBundle at commerce package.</p>
</div>
</div>
<div class="section" id="supported-search-engines">
<h2>Supported Search Engines<a class="headerlink" href="#supported-search-engines" title="Permalink to this headline">¶</a></h2>
<div class="section" id="orm-search-engine">
<h3>ORM Search Engine<a class="headerlink" href="#orm-search-engine" title="Permalink to this headline">¶</a></h3>
<p>ORM search engine doesn&#8217;t use actual document-based storage - instead it emulates such storage inside application relational database using EAV model. As a consequence, performance of ORM engine is not very good and because of that it is recommended only for small applications - with a couple thousands of entities.
ORM search engine uses separate Entity Manager and connection called &#8220;search&#8221; - this way search requests can be processes independently from default DB connection.
ORM search engine for standard index type is implemented at the OroSearchBundle at platform package, for website index type - at the OroWebsiteSearchBundle at commerce package.</p>
<p>See detailed information about the implementation of ORM search engine in the <a class="reference internal" href="db_search/index.html#search-index-db-from-md"><span class="std std-ref">Manage Search in Oro Applications (ORM)</span></a> topic.</p>
</div>
<div class="section" id="elasticsearch-search-engine">
<h3>Elasticsearch Search Engine<a class="headerlink" href="#elasticsearch-search-engine" title="Permalink to this headline">¶</a></h3>
<p>Elasticsearch search engine allows to store big amount of data and perform fast search queries. Performance of Elasticsearch engine is quite good and it&#8217;s recommended for bigger applications - with hundereds of thousands and millions of entities.
Elasitcsearch search engine requires credentials to connect to actual index. Credentials include optional WWW-auth parameters and SSH connection support.
Elasticsearch search engine for standard index type is implemented at the OroElasticSearchBundle at platform-enterprise package, for website index type - at the OroWebsiteElasticSearchBundle at commerce-enterprise package.
Current implementation supports only Elasticsearch 2.* versions.</p>
<p>See detailed information about the implementation of ElasticSearch engine in Oro <a class="reference internal" href="elastic_search.html#elastic-search"><span class="std std-ref">here</span></a>.</p>
</div>
</div>
<div class="section" id="data-structure">
<h2>Data Structure<a class="headerlink" href="#data-structure" title="Permalink to this headline">¶</a></h2>
<div class="section" id="general-information">
<h3>General Information<a class="headerlink" href="#general-information" title="Permalink to this headline">¶</a></h3>
<p>Search index stores documents grouped by entity alias. Each document contain scalar fields with values, one of the fields is all-text field used to perform overall search. Data from the related entities might be stored as well, but in this case it has to be denormalized to a plain structure.
There are four supported entity field value data types:</p>
<ul class="simple">
<li>text</li>
<li>integer (used to represent boolean values)</li>
<li>decimal</li>
<li>datetime (used to represent date values)</li>
</ul>
</div>
<div class="section" id="id1">
<h3>ORM Search Engine<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>ORM search engine stores data using <a class="reference external" href="https://en.wikipedia.org/wiki/Entity%E2%80%93attribute%E2%80%93value_model">EAV model</a> to store attributes. There is one main entity and four related entities used to store data for each of the supported field data types.
One main entity contains main information about the document - entity class, entity ID, entity alias, default title, flag that indicates whether entity was changes and createdAt/updatedAt fields. All four related entities have similar structure - they store name of the entity field and actual entity field value. Here is diagram that shows this structure:</p>
<img alt="../../../_images/op_structure_search_orm.png" src="../../../_images/op_structure_search_orm.png" />
<p>Each of the supported index types uses it&#8217;s own set of entities - i.e. 5 entities for standard index type and 5 more entities for website index type.</p>
</div>
<div class="section" id="id2">
<h3>Elasticsearch Search Engine<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Elasticsearch search engine is document based from the very beginning, so index data structure is pretty straight forward.
Search index is represented by the <a class="reference external" href="https://www.elastic.co/blog/what-is-an-elasticsearch-index">Elasticsearch index</a>.</p>
<p>Search aliases are represented by the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/guide/current/mapping.html">Elasticsearch types</a>.
Search field values are stored inside the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/guide/current/document.html">Elasticsearch document</a>.
Search mapping is defined at the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/guide/current/mapping-intro.html">Elasticsearch mapping</a>, it is generated automatically during the index creation. Here is diagram that shows this structure:</p>
<img alt="../../../_images/op_structure_search_elastic.png" src="../../../_images/op_structure_search_elastic.png" />
<p>Each of the supported index types uses it&#8217;s own Elasticsearch index.</p>
<div class="section" id="example-of-standard-index-type-document">
<h4>Example of Standard Index Type Document<a class="headerlink" href="#example-of-standard-index-type-document" title="Permalink to this headline">¶</a></h4>
<p>Here is example of the document from the standard index type under oro_user entity alias.</p>
<div class="code yaml highlight-php"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="s2">&quot;username&quot;</span><span class="o">:</span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
<span class="s2">&quot;all_text&quot;</span><span class="o">:</span><span class="s2">&quot;admin admin@example.com example com John Doe&quot;</span><span class="p">,</span>
<span class="s2">&quot;email&quot;</span><span class="o">:</span><span class="s2">&quot;admin@example.com&quot;</span><span class="p">,</span>
<span class="s2">&quot;firstName&quot;</span><span class="o">:</span><span class="s2">&quot;John&quot;</span><span class="p">,</span>
<span class="s2">&quot;lastName&quot;</span><span class="o">:</span><span class="s2">&quot;Doe&quot;</span><span class="p">,</span>
<span class="s2">&quot;assigned_organization_id&quot;</span><span class="o">:</span><span class="p">[</span>
   <span class="mi">1</span>
<span class="p">],</span>
<span class="s2">&quot;organization&quot;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span>
<span class="s2">&quot;oro_user_owner&quot;</span><span class="o">:</span><span class="mi">1</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Pay attention to the following facts:</p>
<ul class="simple">
<li>all_text field combines data from all other text fields</li>
<li>assigned_organization_id field contains array of values</li>
</ul>
</div>
<div class="section" id="example-of-website-index-type-document">
<h4>Example of Website Index Type Document<a class="headerlink" href="#example-of-website-index-type-document" title="Permalink to this headline">¶</a></h4>
<p>Here is example of the document from the website index type under oro_product_WEBSITE_ID (WEBSITE_ID = 1) entity alias.</p>
<div class="code yaml highlight-php"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="s2">&quot;assigned_to_variant_31&quot;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span>
<span class="s2">&quot;assigned_to_variant_25&quot;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span>
<span class="s2">&quot;assigned_to_variant_19&quot;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span>
<span class="s2">&quot;assigned_to_variant_11&quot;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span>
<span class="s2">&quot;newArrival&quot;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span>
<span class="s2">&quot;inventory_status_priority&quot;</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span>
<span class="s2">&quot;product_id&quot;</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span>
<span class="s2">&quot;category_id&quot;</span><span class="o">:</span><span class="mi">8</span><span class="p">,</span>
<span class="s2">&quot;visibility_anonymous&quot;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span>
<span class="s2">&quot;visibility_new&quot;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span>
<span class="s2">&quot;is_visible_by_default&quot;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span>
<span class="s2">&quot;all_text_1&quot;</span><span class="o">:</span><span class="s2">&quot;Retail Supplies Credit Card Pin Pad Reader Choosing the right credit card processing terminal to fit your business needs can help you increase your profits and reduce your processing costs. This credit card reader helps you do just that. Its&#39; easy-to-use ATM style interface accepts PIN-based debit card transactions and swipes traditional payment cards. It also accepts chip cards and features a built-in receipt printer Product Information &amp; Features: Catalog Page: 2976 Performs PIN based debit card transactions Accepts chip cards Prints transaction receipts Connectivity: USB (not included) Large, backlit display Supports all magnetic stripe cards Color: Purple Technical Specs: Width: 6\u201d Height: 3\u201d Weight: .6 lb. ACME defaultMetaDescription defaultMetaKeywords 1AB92&quot;</span><span class="p">,</span>
<span class="s2">&quot;sku&quot;</span><span class="o">:</span><span class="s2">&quot;1AB92&quot;</span><span class="p">,</span>
<span class="s2">&quot;all_text&quot;</span><span class="o">:</span><span class="s2">&quot;1AB92 Retail Supplies Credit Card Pin Pad Reader Choosing the right credit card processing terminal to fit your business needs can help you increase your profits and reduce your processing costs. This credit card reader helps you do just that. Its&#39; easy-to-use ATM style interface accepts PIN-based debit card transactions and swipes traditional payment cards. It also accepts chip cards and features a built-in receipt printer Product Information &amp; Features: Catalog Page: 2976 Performs PIN based debit card transactions Accepts chip cards Prints transaction receipts Connectivity: USB (not included) Large, backlit display Supports all magnetic stripe cards Color: Purple Technical Specs: Width: 6\u201d Height: 3\u201d Weight: .6 lb. ACME defaultMetaDescription defaultMetaKeywords&quot;</span><span class="p">,</span>
<span class="s2">&quot;names_1&quot;</span><span class="o">:</span><span class="s2">&quot;Credit Card Pin Pad Reader&quot;</span><span class="p">,</span>
<span class="s2">&quot;shortDescriptions_1&quot;</span><span class="o">:</span><span class="s2">&quot;Choosing the right credit card processing terminal to fit your business needs can help you increase your profits and reduce your processing costs. This credit card reader helps you do just that. Its&#39; easy-to-use ATM style interface accepts PIN-based debit card transactions and swipes traditional payment cards. It also accepts chip cards and features a built-in receipt printer&quot;</span><span class="p">,</span>
<span class="s2">&quot;inventory_status&quot;</span><span class="o">:</span><span class="s2">&quot;out_of_stock&quot;</span><span class="p">,</span>
<span class="s2">&quot;sku_uppercase&quot;</span><span class="o">:</span><span class="s2">&quot;1AB92&quot;</span><span class="p">,</span>
<span class="s2">&quot;status&quot;</span><span class="o">:</span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span>
<span class="s2">&quot;type&quot;</span><span class="o">:</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span>
<span class="s2">&quot;image_product_large&quot;</span><span class="o">:</span><span class="s2">&quot;\/media\/cache\/attachment\/resize\/11\/product_large\/59d20f5ae821f060277950.jpeg&quot;</span><span class="p">,</span>
<span class="s2">&quot;image_product_medium&quot;</span><span class="o">:</span><span class="s2">&quot;\/media\/cache\/attachment\/resize\/11\/product_medium\/59d20f5ae821f060277950.jpeg&quot;</span><span class="p">,</span>
<span class="s2">&quot;product_units&quot;</span><span class="o">:</span><span class="s2">&quot;a:2:{s:4:</span><span class="se">\&quot;</span><span class="s2">item</span><span class="se">\&quot;</span><span class="s2">;i:0;s:3:</span><span class="se">\&quot;</span><span class="s2">set</span><span class="se">\&quot;</span><span class="s2">;i:0;}&quot;</span><span class="p">,</span>
<span class="s2">&quot;category_path&quot;</span><span class="o">:</span><span class="s2">&quot;1_8&quot;</span><span class="p">,</span>
<span class="s2">&quot;category_title_1&quot;</span><span class="o">:</span><span class="s2">&quot;Retail Supplies&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_3_EUR_item&quot;</span><span class="o">:</span><span class="s2">&quot;60.8000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_7_EUR_item&quot;</span><span class="o">:</span><span class="s2">&quot;60.8000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_2_USD_item&quot;</span><span class="o">:</span><span class="s2">&quot;60.8000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_6_USD_item&quot;</span><span class="o">:</span><span class="s2">&quot;60.8000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_4_EUR_item&quot;</span><span class="o">:</span><span class="s2">&quot;60.8000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_1_EUR_item&quot;</span><span class="o">:</span><span class="s2">&quot;76.0000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_5_EUR_item&quot;</span><span class="o">:</span><span class="s2">&quot;60.8000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_5_USD_item&quot;</span><span class="o">:</span><span class="s2">&quot;60.8000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_1_USD_item&quot;</span><span class="o">:</span><span class="s2">&quot;76.0000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_4_USD_item&quot;</span><span class="o">:</span><span class="s2">&quot;60.8000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_6_EUR_item&quot;</span><span class="o">:</span><span class="s2">&quot;60.8000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_2_EUR_item&quot;</span><span class="o">:</span><span class="s2">&quot;60.8000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_7_USD_item&quot;</span><span class="o">:</span><span class="s2">&quot;60.8000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_3_USD_item&quot;</span><span class="o">:</span><span class="s2">&quot;60.8000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_7_EUR&quot;</span><span class="o">:</span><span class="s2">&quot;60.8000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_3_EUR&quot;</span><span class="o">:</span><span class="s2">&quot;60.8000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_1_EUR&quot;</span><span class="o">:</span><span class="s2">&quot;76.0000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_6_USD&quot;</span><span class="o">:</span><span class="s2">&quot;60.8000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_4_EUR&quot;</span><span class="o">:</span><span class="s2">&quot;60.8000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_4_USD&quot;</span><span class="o">:</span><span class="s2">&quot;60.8000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_6_EUR&quot;</span><span class="o">:</span><span class="s2">&quot;60.8000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_1_USD&quot;</span><span class="o">:</span><span class="s2">&quot;76.0000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_3_USD&quot;</span><span class="o">:</span><span class="s2">&quot;60.8000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_7_USD&quot;</span><span class="o">:</span><span class="s2">&quot;60.8000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_5_EUR&quot;</span><span class="o">:</span><span class="s2">&quot;60.8000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_2_USD&quot;</span><span class="o">:</span><span class="s2">&quot;60.8000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_2_EUR&quot;</span><span class="o">:</span><span class="s2">&quot;60.8000&quot;</span><span class="p">,</span>
<span class="s2">&quot;minimal_price_5_USD&quot;</span><span class="o">:</span><span class="s2">&quot;60.8000&quot;</span><span class="p">,</span>
<span class="s2">&quot;tmp_alias&quot;</span><span class="o">:</span><span class="s2">&quot;oro_product_1_website_search59d7a947de6e69.38892637&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Pay attention to the following facts:</p>
<ul class="simple">
<li>multiple values are denormalized to a one level structure according to passed placeholder values - assigned_to_ASSIGN_TYPE_ASSIGN_ID, minimal_price_CPL_ID_CURRENCY_UNIT etc</li>
<li>localized values are related to specific locale (LOCALIZATION_ID = 1) - names_LOCALIZATION_ID, shortDescriptions_LOCALIZATION_ID etc</li>
<li>standard and localized all-text fields (LOCALIZATION_ID = 1) - all_text and all_text_LOCALIZATION_ID</li>
<li>tmp_alias field is used to maintain outdated data during the reindexation and understand which entities has to be removed after the reindexation</li>
</ul>
</div>
</div>
</div>
<div class="section" id="search-request">
<h2>Search Request<a class="headerlink" href="#search-request" title="Permalink to this headline">¶</a></h2>
<p>To perform search request developer has to build a query to search index. There are two representations of search query - string represenation and object represenation.</p>
<div class="section" id="string-representation">
<h3>String Representation<a class="headerlink" href="#string-representation" title="Permalink to this headline">¶</a></h3>
<p>String representation is pretty similar to standard SQL query - this string may contain keywords select, from, where, aggregate, order_by, offset and max_results. String represenation is used mostly at the API where user can request specific data with specific condition. During the processing of string representation it&#8217;s converted to object representation.</p>
</div>
<div class="section" id="object-representation">
<h3>Object Representation<a class="headerlink" href="#object-representation" title="Permalink to this headline">¶</a></h3>
<p>Object representation has two levels - low and high.
<strong>Low-level object</strong> (OroBundleSearchBundleQueryQuery, sometime called search query builder) represents a query and has parts similar to string represenation (select, where etc). Low-level query is not aware about specific search engine. It&#8217;s used by all search engines as a main query representation. Low-level object is in fact a <a class="reference external" href="https://en.wikipedia.org/wiki/Data_transfer_object">Data transfer object</a>.
<strong>High-level object</strong> (implementation of OroBundleSearchBundleQuerySearchQueryInterface) is used to hide search engine specific logic from a developer. It embeds low-level object and proxies most of the calls. High-level objects are created by the query factory (implementation of OroBundleSearchBundleQueryFactoryQueryFactoryInterface). Each index type has it&#8217;s own implementation of high-level object which encapsulates the way this query has to be executed, and it&#8217;s own implementation of query factory responsible for creation of high-level object. High-level object is in fact a <a class="reference external" href="https://en.wikipedia.org/wiki/Facade_pattern">Facade</a>.
Following diagram demonstrates connection between low-level object, high-level object, query factory and search engine:</p>
<img alt="../../../_images/op_structure_search_index_object_representation.png" src="../../../_images/op_structure_search_index_object_representation.png" />
</div>
<div class="section" id="how-to-trigger-search-request">
<h3>How to Trigger Search Request<a class="headerlink" href="#how-to-trigger-search-request" title="Permalink to this headline">¶</a></h3>
<p>The recommended way to trigger search request is to get instance of high-level object, build a query, execute it and get results. It&#8217;s also recommended to isolate all search requests in a search repository (see <a class="reference internal" href="#best-practices">Best Practices</a> section) to separate storage logic from business logic.
However, if you really need to work on a lower level (e.g. to write functional test) then you can get instance of an appropriate search engine type. All following engines implement standard search engine interface OroBundleSearchBundleEngineEngineInterface:</p>
<ul class="simple">
<li>standard ORM engine - OroBundleSearchBundleEngineOrm, service ID is oro_search.search.engine;</li>
<li>standard Elasticsearch engine - OroBundleElasticSearchBundleEngineElasticSearch, service ID is oro_search.search.engine;</li>
<li>website ORM engine - OroBundleWebsiteSearchBundleEngineORMOrmEngine, service ID is oro_website_search.engine;</li>
<li>website Elasticsearch engine - OroBundleWebsiteElasticSearchBundleEngineElasticSearchEngine, service ID is oro_website_search.engine.</li>
</ul>
<p>All these engines accept low-level query and execution context as an arguments, and return result object with list of found entities, total number of results and requested aggregated data.</p>
</div>
</div>
<div class="section" id="indexation-process">
<h2>Indexation Process<a class="headerlink" href="#indexation-process" title="Permalink to this headline">¶</a></h2>
<div class="section" id="asynchronous-indexation">
<h3>Asynchronous Indexation<a class="headerlink" href="#asynchronous-indexation" title="Permalink to this headline">¶</a></h3>
<p>Most of the indexation operations are performed asynchronously using a message queue. Advantage of this approach is that user should not wait while indexation is finished to see response from the application, also asynchronous indexations might be perfromed in parallel to speed up overall indexation process. Disadvantage is that indexation may happen with a delay - delay time depends on number of consumers, server hardware and queue length.
Every time some entity which should be represented by a document in a search index is changed new message that contains entity class and entity identifier is generated and sent to message queue. Then message queue consumer receives this message and runs appropriate message processor that performs real indexation and does real change in search index.
Please, remember, that parallel indexation is possible only if there are several message queue consumers running - each consumer is able to run indexation, so the bigger amount of consumers running the more indexations can be performed in parallel.
All automatically triggered reindexations are processed asynchronously.</p>
</div>
<div class="section" id="synchronous-indexation">
<h3>Synchronous Indexation<a class="headerlink" href="#synchronous-indexation" title="Permalink to this headline">¶</a></h3>
<p>Despite the fact, that asynchronous processing is very convenient for a user, sometimes it might be required to track process manually and make sure that indexation is finished right away. In this case synchronous indexation should be used instead of the asynchronous one. Advantage of this approach that indexation will happen right now without any delay. Disadvantage is that it might be slower and UX is worse than in case of asynchronous indexations.</p>
</div>
<div class="section" id="how-to-trigger-reindexation">
<h3>How to Trigger Reindexation<a class="headerlink" href="#how-to-trigger-reindexation" title="Permalink to this headline">¶</a></h3>
<p>Both standard and website index types automatically trigger reindexation process when entity data or related configuration is changed.</p>
<p>Standard search index type provides CLI command oro:search:reindex that can be used to manually tirgger full reindexation of all entities, or only entities of a specific class. It has flag called scheduled to run indexation asynchronously. Here are <a class="reference external" href="https://github.com/oroinc/platform/blob/master/src/Oro/Bundle/SearchBundle/Resources/doc/console_commands.md">examples of a work with this command</a>.</p>
<p>Website search index type provides similar CLI command called oro:website-search:reindex which used to manually tirgger full reindexation of all entities, only entities of a specific class or entitie for a specific website. It also has flag called scheduled to run indexation  asynchronously. Here are <a class="reference external" href="https://github.com/oroinc/orocommerce/blob/master/src/Oro/Bundle/WebsiteSearchBundle/Resources/doc/console_commands.md">examples of a work with oro:website-search:reindex command</a>.</p>
<p>Website search index type provides an event called oro_website_search.reindexation_request to manually trigger reindexation process for the specified scope of entities. It uses event class OroBundleWebsiteSearchBundleEventReindexationRequestEvent which accepts boolean parameter $scheduled to specify whether indexation has to be asynchronous (default behaviour) or synchronous. Here are <a class="reference external" href="https://github.com/oroinc/orocommerce/blob/master/src/Oro/Bundle/WebsiteSearchBundle/Resources/doc/indexation.md">examples of a triggering of this event</a>.</p>
<p>Both standard and website search index types have synchronous and asynchronous indexers which trigget corresponding type of indexation. All following indexers implement the same standard indexer interface OroBundleSearchBundleEngineIndexerInterface:</p>
<ul class="simple">
<li>standard asynchronous indexer - OroBundleSearchBundleAsyncIndexer, service ID is oro_search.async.indexer</li>
<li>standard synchronous ORM indexer - OroBundleSearchBundleEngineOrmIndexer, service ID is oro_search.search.engine.indexer</li>
<li>standard synchronous Elasticsearch - OroBundleElasticSearchBundleEngineElasticSearchIndexer, service ID is oro_search.search.engine.indexer</li>
<li>website asynchronous indexer - OroBundleWebsiteSearchBundleEngineAsyncIndexer, service ID is oro_website_search.async.indexer</li>
<li>website ORM indexer - OroBundleWebsiteSearchBundleEngineORMOrmIndexer, service ID is oro_website_search.indexer</li>
<li>website Elasticsearch indexer - OroBundleWebsiteElasticSearchBundleEngineElasticSearchIndexer, service ID is oro_website_search.indexer</li>
</ul>
<p>All these indexers accept entities of entity class that has to be reindexed.</p>
</div>
</div>
<div class="section" id="acl-restrictions">
<h2>ACL Restrictions<a class="headerlink" href="#acl-restrictions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id3">
<h3>Standard Index Type<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>Standard index type automatically adds owner and organization fields to all entities and fills them with data during the indexation process. Then during the search request ACL restrictions are automatically applied to a low-level query to show only entities which current user is allowed to see.</p>
</div>
<div class="section" id="id4">
<h3>Website Index Type<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>Website index type doesn&#8217;t have common ACL protection like standard index type. Instead each entity can be protected by the custom specific conditions. For example, visibility of a Product entity to a cutomer user is affected by a product status, product inventory status and product visibility settings on a customer, customer group and website levels.</p>
</div>
</div>
<div class="section" id="scalability">
<h2>Scalability<a class="headerlink" href="#scalability" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id5">
<h3>ORM Search Engine<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>ORM search engine uses DBMS as a main storage and its scalability depends on scalability of DBMS. For example, PostgreSQL supports <a class="reference external" href="https://wiki.postgresql.org/wiki/Replication,_Clustering,_and_Connection_Pooling">several clustering solutions</a>, so ORM search index can be scaled together with the main relational DB.
There is one more trick that can be used. As long as ORM search engine uses it&#8217;s own connection and it&#8217;s own entity manager, all search related tables can be moved to a separate DB at the remote server. In this case application administrator has to override configuration for connection called search and refer to this remote server.</p>
</div>
<div class="section" id="id6">
<h3>Elasticsearch Search Engine<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>Elasticsearch search engine is horizontally scalable out of the box - it can be organized as an <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/guide/current/distributed-cluster.html">Elasticsearch cluster</a> with a several nodes inside it. Application administrator can specify how many <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/guide/current/overallocation.html">Elasticsearch shards</a> index will consist of (i.e. how many parts it will be split into), default number of shards is 5. Then depending on the number of nodes at cluster, search engine can move shards to different nodes and, as a consequence, allow to perform <a class="reference external" href="https://medium.com/hipages-engineering/scaling-elasticsearch-b63fa400ee9e">distributed search</a>.</p>
</div>
</div>
<div class="section" id="unavailability-handling">
<h2>Unavailability Handling<a class="headerlink" href="#unavailability-handling" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id7">
<h3>General Information<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>Search index does not provide any additional logic to recognize that index not available. Not availability is processed on a storage level only.</p>
</div>
<div class="section" id="id8">
<h3>ORM Search Engine<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>ORM search engine uses DBMS as a main storage and ability to handle unavilable state of a storage depends on how it&#8217;s organized at the used DBMS. Both <a class="reference external" href="https://dev.mysql.com/doc/refman/5.7/en/replication.html">MySQL</a> and <a class="reference external" href="https://wiki.postgresql.org/wiki/Replication,_Clustering,_and_Connection_Pooling">PostgreSQL</a> support repliacation, which can be used to manage such situation.
If you have search index at the separate DB then you can organize replication exclusively for this DB.</p>
</div>
<div class="section" id="id9">
<h3>Elasticsearch Search Engine<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>Elasticsearch search engine support replications as well. Application administrator can specify how many <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/guide/current/replica-shards.html">Elasticsearch replicas</a> index should have, default number of replicas is 1. After that Elasticsearch cluster will create appropriate number of replica shards and distribute them over the available nodes.
For example, by default index is created with 5 shards and 1 replica - it means that Elasticsearch will create 10 shards: 5 primary shards and 5 replica shards.</p>
</div>
</div>
<div class="section" id="logging">
<h2>Logging<a class="headerlink" href="#logging" title="Permalink to this headline">¶</a></h2>
<p>Loggin is an essential part of any conponent, and search component is not an exception. Both standard and website search indexes in dev mode log all requests to search index storages (DB or Elasticsearch); in prod mode only exceptions are logged. In case of prod mode all exceptions are also sent to an emails specified in system configurations at System Configuration &gt; General setup &gt; Application settings &gt; Error logs notification section.
Standard search index also may log all search queries to database table oro_search_query (entity name is OroBundleSearchBundleEntityQuery), by default this logging is turned off.
Elasticsearch engine impelementations uses their own Monolog logger channels - oro_elastic_search for standard index type and oro_website_elastic_search for website index type.</p>
</div>
<div class="section" id="use-cases">
<h2>Use Cases<a class="headerlink" href="#use-cases" title="Permalink to this headline">¶</a></h2>
<div class="section" id="datagrids">
<h3>Datagrids<a class="headerlink" href="#datagrids" title="Permalink to this headline">¶</a></h3>
<p>There is a special datagrid search datasource that works with search index. Search datasource works with high-level search query object, so both index types are supported. Datagrids based on this datasource use <a class="reference external" href="https://github.com/oroinc/platform/blob/master/src/Oro/Bundle/SearchBundle/Resources/doc/configuration.md#datagrid-configuration">configuration similar to ORM configuration</a> - developer can specify shown columns, filters, sorters, properties and actions.</p>
<p>Implemented search datagrids:</p>
<ul class="simple">
<li>search results grid (search-grid) - used to show results of overall search at all Oro applications, grid may show any entity;</li>
<li>products frontend grid (frontend-product-search-grid) - used as to represent list of products and show product search results at OroCommerce frontend part, grid shows only Product entities.</li>
</ul>
</div>
<div class="section" id="autocomplete">
<h3>Autocomplete<a class="headerlink" href="#autocomplete" title="Permalink to this headline">¶</a></h3>
<p>Autocomplete form types by default use standard search index type to find entities and show them to user (see OroBundleFormBundleAutocompleteSearchHandler). They don&#8217;t use niether string, nor object query representation directly - instead it uses the indexer from the standard search index, which uses low-level query object inside.</p>
</div>
<div class="section" id="simple-and-advanced-search-api">
<h3>Simple and Advanced Search API<a class="headerlink" href="#simple-and-advanced-search-api" title="Permalink to this headline">¶</a></h3>
<p>Standard search index provides API resources that can be used to work with this search index.</p>
<p>Simple search API accepts:</p>
<ul class="simple">
<li>search request - plain string used to perform search at all-text field;</li>
<li>entity alias (optional);</li>
<li>offset (optional) - used for paginattion;</li>
<li>max results (optional) - used for pagination.</li>
</ul>
<p>Advanced search API accepts string representation of search request.</p>
<p>In both cases API returns list of found entities.</p>
</div>
</div>
<div class="section" id="best-practices">
<h2>Best Practices<a class="headerlink" href="#best-practices" title="Permalink to this headline">¶</a></h2>
<div class="section" id="use-data-denormalization">
<h3>Use Data Denormalization<a class="headerlink" href="#use-data-denormalization" title="Permalink to this headline">¶</a></h3>
<p>Search index is a document based storage and it does not support relations. Instead you can denormalize them and store related information at the main entity level - this way you can increase search speed.
For example, if Product entity has a relation to Brand entity then Product document at the search index may store some brand information (ID, label etc) which might be required to do effective and fast search.</p>
</div>
<div class="section" id="isolate-search-index-interaction-inside-search-repositories">
<h3>Isolate Search Index Interaction Inside Search Repositories<a class="headerlink" href="#isolate-search-index-interaction-inside-search-repositories" title="Permalink to this headline">¶</a></h3>
<p>Every time you want to request some custom information from the search index you should get it via the search repository. Search repository provides a storage abstraction layer (similar to Doctrine entity repositories), so business logic will be aware about the repository, but not about the search index structure.
If you want to create a repository then you should create new class extended from the appropriate search repository class (OroBundleSearchBundleQuerySearchRepository for standard index type or OroBundleWebsiteSearchBundleQueryWebsiteSearchRepository for website index type), declare it as a service, add custom methods and inject it into required business logic service. Search repositories work with the high-level search query object representations. You can optinally pass entity name as well - in this case queries will be by default executed only for the specific entity.
Here is example of search repository for standard index type and its definition:</p>
<div class="code php highlight-php"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Oro\Bundle\UserBundle\Search</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Oro\Bundle\SearchBundle\Query\Criteria\Criteria</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Oro\Bundle\SearchBundle\Query\Query</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Oro\Bundle\SearchBundle\Query\SearchRepository</span><span class="p">;</span>

<span class="sd">/**</span>
<span class="sd"> * Search repository used to extract user data from standard search index</span>
<span class="sd"> */</span>
<span class="k">class</span> <span class="nc">UserRepository</span> <span class="k">extends</span> <span class="nx">SearchRepository</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * @param string $domain</span>
<span class="sd">     * @return array</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getUserIdsByEmailDomain</span><span class="p">(</span><span class="nv">$domain</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$elements</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">createQuery</span><span class="p">()</span>
            <span class="o">-&gt;</span><span class="na">addWhere</span><span class="p">(</span><span class="nx">Criteria</span><span class="o">::</span><span class="na">expr</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">like</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="nv">$domain</span><span class="p">))</span>
            <span class="o">-&gt;</span><span class="na">setMaxResults</span><span class="p">(</span><span class="nx">Query</span><span class="o">::</span><span class="na">INFINITY</span><span class="p">)</span>
            <span class="o">-&gt;</span><span class="na">getResult</span><span class="p">()</span>
            <span class="o">-&gt;</span><span class="na">getElements</span><span class="p">();</span>

        <span class="nv">$userIds</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$elements</span> <span class="k">as</span> <span class="nv">$element</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$userIds</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$element</span><span class="o">-&gt;</span><span class="na">getRecordId</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nv">$userIds</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="code yaml highlight-php"><div class="highlight"><pre><span></span><span class="nx">services</span><span class="o">:</span>
    <span class="nx">oro_user</span><span class="o">.</span><span class="nx">search</span><span class="o">.</span><span class="nx">repository</span><span class="o">.</span><span class="nx">user</span><span class="o">:</span>
        <span class="nx">class</span><span class="o">:</span> <span class="s1">&#39;Oro\Bundle\UserBundle\Search\UserRepository&#39;</span>
        <span class="nx">arguments</span><span class="o">:</span>
            <span class="o">-</span> <span class="s1">&#39;@oro_search.query_factory&#39;</span>
            <span class="o">-</span> <span class="s1">&#39;@oro_search.provider.search_mapping&#39;</span>
        <span class="nx">calls</span><span class="o">:</span>
            <span class="o">-</span> <span class="p">[</span><span class="nx">setEntityName</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Oro\Bundle\UserBundle\Entity\User&#39;</span><span class="p">]]</span>
</pre></div>
</div>
<p>And here is example of search repository for website index type and its definition:</p>
<div class="code php highlight-php"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Oro\Bundle\ProductBundle\Search</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Oro\Bundle\SearchBundle\Query\Criteria\Criteria</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Oro\Bundle\SearchBundle\Query\SearchQueryInterface</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Oro\Bundle\WebsiteSearchBundle\Query\WebsiteSearchRepository</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">ProductRepository</span> <span class="k">extends</span> <span class="nx">WebsiteSearchRepository</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * @param array $skus</span>
<span class="sd">     * @return SearchQueryInterface</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getFilterSkuQuery</span><span class="p">(</span><span class="nv">$skus</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$searchQuery</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">createQuery</span><span class="p">();</span>

        <span class="c1">// Convert to uppercase for insensitive search</span>
        <span class="nv">$upperCaseSkus</span> <span class="o">=</span> <span class="nb">array_map</span><span class="p">(</span><span class="s2">&quot;strtoupper&quot;</span><span class="p">,</span> <span class="nv">$skus</span><span class="p">);</span>

        <span class="nv">$searchQuery</span>
            <span class="o">-&gt;</span><span class="na">addSelect</span><span class="p">(</span><span class="s1">&#39;sku&#39;</span><span class="p">)</span>
            <span class="o">-&gt;</span><span class="na">addSelect</span><span class="p">(</span><span class="s1">&#39;names_LOCALIZATION_ID as name&#39;</span><span class="p">)</span>
            <span class="o">-&gt;</span><span class="na">addWhere</span><span class="p">(</span><span class="nx">Criteria</span><span class="o">::</span><span class="na">expr</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">in</span><span class="p">(</span><span class="s1">&#39;sku_uppercase&#39;</span><span class="p">,</span> <span class="nv">$upperCaseSkus</span><span class="p">));</span>

        <span class="k">return</span> <span class="nv">$searchQuery</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="code yaml highlight-php"><div class="highlight"><pre><span></span><span class="nx">oro_product</span><span class="o">.</span><span class="nx">website_search</span><span class="o">.</span><span class="nx">repository</span><span class="o">.</span><span class="nx">product</span><span class="o">:</span>
    <span class="k">parent</span><span class="o">:</span> <span class="nx">oro_website_search</span><span class="o">.</span><span class="nx">repository</span><span class="o">.</span><span class="k">abstract</span>
    <span class="nx">class</span><span class="o">:</span> <span class="s1">&#39;Oro\Bundle\ProductBundle\Search\ProductRepository&#39;</span>
    <span class="nx">calls</span><span class="o">:</span>
        <span class="o">-</span> <span class="p">[</span><span class="nx">setEntityName</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Oro\Bundle\ProductBundle\Entity\Product&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="section" id="avoid-working-directly-with-the-search-engine-and-search-indexer">
<h3>Avoid Working Directly with the Search Engine and Search Indexer<a class="headerlink" href="#avoid-working-directly-with-the-search-engine-and-search-indexer" title="Permalink to this headline">¶</a></h3>
<p>Please, don&#8217;t use search engine and search indexer at the production code directly.
If you need to perform search request it&#8217;s better to encapsulate it inside search repository.
If you need to trigger reindexation then you should remember, that most of the data is reindexed automatically; if you need to do manual reindexation you can usually do it on a higher level - e.g. you can trigger an event at website index type.
If for some reason you still have to work directly with search engine or search indexer - please, encapsulate all your logic inside the intermediate storage layer service (similar to search repository) and use it at the business logic layer. This way business logic will be aware about a storage, but not about the structure of the search index itself.</p>
</div>
<div class="section" id="debugging">
<h3>Debugging<a class="headerlink" href="#debugging" title="Permalink to this headline">¶</a></h3>
<p>If you need to debug some search requests/indexations, but don&#8217;t know an entry point to it, then you can set a breakpoint in the appropriate engine/indexer (or all engines/indexers) - this way after you catch the breakpoint you&#8217;ll be able to track whole stack trace. The most commonly used method for a search engine is search; the most commonly used methods for a search indexers are save and delete.
Please, remember, that most of the indexations are happended asynchronously - so, if you want to debug real indexation you should set breakpoint at the appropriate indexer, run message queue consumer in debug mode to be able to catch breakpoint and then trigger asynchronous indexation.
If you need to debug remote server and you don&#8217;t have an access to it then you should configure logging there and see results in logs.</p>
</div>
<div class="section" id="testing">
<h3>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h3>
<p>Search index interaction like any storage interaction have to be covered with functional tests. In functional tests you can work directly with the search repository, search engine or search indexer.
You can and you should also cover search index interaction with behat tests as well.</p>
</div>
<div class="section" id="useful-elasticsearch-plugins">
<h3>Useful Elasticsearch Plugins<a class="headerlink" href="#useful-elasticsearch-plugins" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://www.elastichq.org/">Elastic HQ</a> is a very useful plugin for developers because it provides UI to manage Elasticsearch cluster (indexes, mappings, queries etc) instead of the plain CLI. This plugin is recommended to use only at the development environment because of the possible security issues at production environment.</p>
</div>
<div class="section" id="search-index-optimization">
<h3>Search Index Optimization<a class="headerlink" href="#search-index-optimization" title="Permalink to this headline">¶</a></h3>
<p>There are several ways how you can optimize search index and speed up search and indexation speed.</p>
<ul class="simple">
<li>Change search engine. If you&#8217;re using ORM search engine then you can switch to Elasticsearch engine and do full reindexation (might take some time). ORM search engine uses EAV model to store documents at the relational storage, which is not very efficient and fast approach. However, Elasticsearch engine is document based originally, so it works faster and shows much better performance.</li>
<li>Storage optimization. You can improve hardware used for a search index storage - more RAM, more processing cores, faster disk (SSD) etc. If you&#8217;re using ORM search engine then you can check performance of a standard search queries - just get queries, do EXPLAIN and see how you can optimize DBMS.</li>
<li>Index data optimization. You can check what entity data is not required (or not used) at a search index, remove it from mapping and/or indexed data and trigger full reindexation (might take some time). After that each search document should become smaller and whole index should take less space on a disk.</li>
<li>Index structure optimization. If you&#8217;re using Elasticsearch you may change the way full-text index is built - you can change default index analyzers, index tokenizers and index token filters to the faster ones.</li>
<li>Accessibility optimization. You can measure delay required to connect to a search index storage and try to decrease this value - e.g. move it to a server with smaller network delay and connection time. If you&#8217;re using Elasticsearch cluster then you can check where shards and replicas are placed and optimize this infrastructure as well.</li>
</ul>
</div>
<div class="section" id="how-to-work-with-big-data">
<h3>How to Work with Big Data<a class="headerlink" href="#how-to-work-with-big-data" title="Permalink to this headline">¶</a></h3>
<p>Here are couple of recommendations how to work properly with search index with a big amount of data - 1 million of entities and more.</p>
<ul class="simple">
<li><strong>Run indexation in parallel</strong> - split scope of indexed entities on a small chunks (1000-10000 entities) and make sure that there are enough consumers to process them in parallel.</li>
<li><strong>Use Elasticsearch engine</strong> - it&#8217;s faster and performs much better than ORM search engine in case of big amout of data.</li>
<li><strong>Use language optimization</strong> - if you know what languages are used at your application then you can optimize index structure and data according to these languagues; see list of Elasticsearch language analyzers.</li>
<li><strong>Keep search index at the separate server</strong> - this way it will not be affected by main relational DB load.</li>
<li><strong>Use Elasticseach cluster if needed</strong> - if your index is too big to keep it on one server and/or you want to balance search index load between several servers then you might use Elasticseach cluster.</li>
<li><strong>Increase RAM</strong> - the recommended amount of RAM for search index is a half of index size or more, i.e. if you have 50GB of index data it&#8217;s recommended to have 25GB+ of RAM.</li>
<li><strong>Use SSD</strong> - this type of disk provides faster read/write access than HDD and allows to request parts of search index data faster.</li>
</ul>
</div>
</div>
<div class="section" id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h2>
<div class="section" id="search-index-shows-outdated-data">
<h3>Search Index Shows Outdated Data<a class="headerlink" href="#search-index-shows-outdated-data" title="Permalink to this headline">¶</a></h3>
<p>Entity that was changed might be not indexed yet and reindexation request message is still waiting in message queue. Please, make sure that consumer is running, all messages are processed and then try again.</p>
</div>
<div class="section" id="new-entity-does-not-appear-in-the-search-results">
<h3>New Entity Does Not Appear in the Search Results<a class="headerlink" href="#new-entity-does-not-appear-in-the-search-results" title="Permalink to this headline">¶</a></h3>
<p><strong>First possible reason:</strong> New entity might be not indexed yet and reindexation request message is still waiting in message queue. Please, make sure that consumer is running, all messages are processed and then try again.
<strong>Second possible reason:</strong> Current user is  not allowed to see new entity.
Standard search index type: Current user doesn&#8217;t have permissions to see the entity. Please, have a look at ownership and organization of the entity and check if current user have an access to it.
Website search index type: The entity is invisible to a current user. Please, check parameters that might affect visibility of the entity to a current user (statuses, visibility restrictions, system configuration etc).</p>
</div>
<div class="section" id="cannot-connect-to-elasticsearch">
<h3>Cannot Connect to Elasticsearch<a class="headerlink" href="#cannot-connect-to-elasticsearch" title="Permalink to this headline">¶</a></h3>
<p>Please, verify credentials specified at the app/confing/parameters.yml file - host, port, index name, authentication options. You can try to manually connect to Elasticsearch server via CLI curl command to make sure that you have an access to it:</p>
<div class="code yaml highlight-php"><div class="highlight"><pre><span></span><span class="err">$</span> <span class="nx">curl</span> <span class="o">-</span><span class="nx">I</span> <span class="nx">http</span><span class="o">://</span><span class="nx">localhost</span><span class="o">:</span><span class="mi">9200</span>
<span class="nx">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">200</span> <span class="nx">OK</span>
<span class="nx">Content</span><span class="o">-</span><span class="nx">Type</span><span class="o">:</span> <span class="nx">text</span><span class="o">/</span><span class="nx">plain</span><span class="p">;</span> <span class="nx">charset</span><span class="o">=</span><span class="nx">UTF</span><span class="o">-</span><span class="mi">8</span>
<span class="nx">Content</span><span class="o">-</span><span class="nx">Length</span><span class="o">:</span> <span class="mi">0</span>

<span class="err">$</span> <span class="nx">curl</span> <span class="o">-</span><span class="nx">I</span> <span class="nx">http</span><span class="o">://</span><span class="nx">localhost</span><span class="o">:</span><span class="mi">9200</span><span class="o">/</span><span class="nx">index_name</span>
<span class="nx">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">200</span> <span class="nx">OK</span>
<span class="nx">Content</span><span class="o">-</span><span class="nx">Type</span><span class="o">:</span> <span class="nx">text</span><span class="o">/</span><span class="nx">plain</span><span class="p">;</span> <span class="nx">charset</span><span class="o">=</span><span class="nx">UTF</span><span class="o">-</span><span class="mi">8</span>
<span class="nx">Content</span><span class="o">-</span><span class="nx">Length</span><span class="o">:</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="section" id="different-search-engines-return-different-results">
<h3>Different Search Engines Return Different Results<a class="headerlink" href="#different-search-engines-return-different-results" title="Permalink to this headline">¶</a></h3>
<p>Implementation of full-text search depends on a storage type, so different engines might return slightly different results and this is valid behaviour. Oro applications may use three different full-text search algorithms - Mysql DBMS full-text search, PostgreSQL DBMS full-text search or Elasticsearch full-text search.</p>
</div>
<div class="section" id="need-to-reindex-entities">
<h3>Need to Reindex Entities<a class="headerlink" href="#need-to-reindex-entities" title="Permalink to this headline">¶</a></h3>
<p>If your index is totally broken and you need to create it from scratch, or you need to refresh only specific scope of entities then you should use reindexation command.</p>
<p>Standard search index provides following CLI commands (<a class="reference external" href="https://github.com/oroinc/platform/blob/master/src/Oro/Bundle/SearchBundle/Resources/doc/console_commands.md">here are examples of a work with these commands</a>):</p>
<ul class="simple">
<li><em>oro:search:reindex</em> - allows to reindex all entities or only of a specific entity class; indexation can be synchronous (default behaviour) or asynchronous;</li>
<li><em>oro:search:index</em> - allows to reindex specific entities by their entity class and identifiers; indexation is asynchronous.</li>
</ul>
<p>Website search index provides following command (<a class="reference external" href="https://github.com/oroinc/orocommerce/blob/master/src/Oro/Bundle/WebsiteSearchBundle/Resources/doc/console_commands.md">hear are examples of a work with this command</a>):</p>
<ul class="simple">
<li><strong>oro:website-search:reindex</strong> - allows to reindex all entities, or only of a specific entity class, or entities for a specific website, or specific entities by their identifiers; indexation can be synchronous (default behaviour) or asynchronous.</li>
</ul>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/2.4/index.html">Elasticsearch references</a></li>
<li><a class="reference external" href="https://medium.com/hipages-engineering/scaling-elasticsearch-b63fa400ee9e">Scaling Elasticsearch</a></li>
<li><a class="reference external" href="https://www.safaribooksonline.com/library/view/web-performance-tuning/059600172X/ch04s02.html">Web Performance Tuning: Latency and Throughput</a></li>
<li><a class="reference external" href="https://github.com/laboro/dev/blob/master/package/platform/src/Oro/Bundle/SearchBundle/README.md">Standard search index type</a></li>
<li><a class="reference external" href="https://github.com/laboro/dev/blob/master/package/platform-enterprise/src/Oro/Bundle/ElasticSearchBundle/README.md">Elasticsearch support for standard index type</a></li>
<li><a class="reference external" href="https://github.com/laboro/dev/blob/master/package/commerce/src/Oro/Bundle/WebsiteSearchBundle/README.md">Website search index type</a></li>
<li><a class="reference external" href="https://github.com/laboro/dev/blob/master/package/commerce-enterprise/src/Oro/Bundle/WebsiteElasticSearchBundle/README.md">Elasticsearch support for website index type</a></li>
</ul>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="elastic_search.html">Elasticsearch</a><ul>
<li class="toctree-l2"><a class="reference internal" href="elastic_search.html#system-requirements">System Requirements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="elastic_search.html#elasticsearch-supported-versions">Elasticsearch Supported Versions</a></li>
<li class="toctree-l3"><a class="reference internal" href="elastic_search.html#required-plugins">Required Plugins</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="elastic_search.html#configuration">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="elastic_search.html#parameters">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="elastic_search.html#client-configuration">Client Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="elastic_search.html#index-configuration">Index Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="elastic_search.html#disable-environment-checks">Disable Environment Checks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="elastic_search.html#index-agent-and-search-engine">Index Agent and Search Engine</a><ul>
<li class="toctree-l3"><a class="reference internal" href="elastic_search.html#index-agent">Index Agent</a></li>
<li class="toctree-l3"><a class="reference internal" href="elastic_search.html#search-engine">Search Engine</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="elastic_search.html#request-builders">Request Builders</a><ul>
<li class="toctree-l3"><a class="reference internal" href="elastic_search.html#fromrequestbuilder">FromRequestBuilder</a></li>
<li class="toctree-l3"><a class="reference internal" href="elastic_search.html#whererequestbuilder">WhereRequestBuilder</a></li>
<li class="toctree-l3"><a class="reference internal" href="elastic_search.html#orderrequestbuilder">OrderRequestBuilder</a></li>
<li class="toctree-l3"><a class="reference internal" href="elastic_search.html#limitrequestbuilder">LimitRequestBuilder</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="elastic_search.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="elastic_search.html#got-exception-no-alive-nodes-found-in-your-cluster-during-installation-or-indexation">Got exception <cite>No alive nodes found in your cluster</cite> during installation or indexation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="db_search/index.html">Manage Search in Oro Applications (ORM)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="db_search/configuration.html">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="db_search/configuration.html#system-configuration">System Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="db_search/configuration.html#configuration-merging">Configuration Merging</a><ul>
<li class="toctree-l3"><a class="reference internal" href="db_search/configuration.html#example">Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="db_search/configuration.html#entity-configuration">Entity Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="db_search/configuration.html#search-engine-configuration">Search Engine Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="db_search/configuration.html#datagrid-configuration">Datagrid Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="db_search/console_commands.html">Console Commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="db_search/console_commands.html#oro-search-index">oro:search:index</a></li>
<li class="toctree-l3"><a class="reference internal" href="db_search/console_commands.html#oro-search-reindex">oro:search:reindex</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="db_search/simple_search.html">API Simple Search</a><ul>
<li class="toctree-l3"><a class="reference internal" href="db_search/simple_search.html#result">Result</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="db_search/advanced_search.html">API Advanced Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="db_search/advanced_search.html#result">Result</a></li>
<li class="toctree-l2"><a class="reference internal" href="db_search/advanced_search.html#query-language">Query Language</a><ul>
<li class="toctree-l3"><a class="reference internal" href="db_search/advanced_search.html#keywords">Keywords</a><ul>
<li class="toctree-l4"><a class="reference internal" href="db_search/advanced_search.html#select">select</a></li>
<li class="toctree-l4"><a class="reference internal" href="db_search/advanced_search.html#from">from</a></li>
<li class="toctree-l4"><a class="reference internal" href="db_search/advanced_search.html#where">where</a></li>
<li class="toctree-l4"><a class="reference internal" href="db_search/advanced_search.html#and-or">and, or</a></li>
<li class="toctree-l4"><a class="reference internal" href="db_search/advanced_search.html#offset">offset</a></li>
<li class="toctree-l4"><a class="reference internal" href="db_search/advanced_search.html#max-results">max_results</a></li>
<li class="toctree-l4"><a class="reference internal" href="db_search/advanced_search.html#order-by">order_by</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="db_search/advanced_search.html#field-types">Field Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="db_search/advanced_search.html#operators">Operators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="db_search/advanced_search.html#for-string-fields">For String Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="db_search/advanced_search.html#for-numeric-fields">For Numeric Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="db_search/advanced_search.html#query-brackets">Query Brackets</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="db_search/advanced_search.html#query-examples">Query Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="db_search/query_builder.html">Query Builder</a></li>
<li class="toctree-l2"><a class="reference internal" href="db_search/orm_search_engine.html">ORM Search Engine</a><ul>
<li class="toctree-l3"><a class="reference internal" href="db_search/orm_search_engine.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="db_search/orm_search_engine.html#features">Features</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../install_upgrade/index.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../user_guide/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../seo_config_guide/index.html">SEO Configuration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../frontstore_guide/index.html">Front Store Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev_guide/index.html">Developer Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Administrator Guide</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Operational Structure</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Search Index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../database/index.html">DataBase System Component</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cache.html">Cache in Oro Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mq/index.html">Message Queue</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../optimize_server_compression_and_caching.html">Web Server Performance Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../price_list_sharding.html">How to Configure Price List Sharding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../optimize_index_and_price_calculation.html">Optimize Website Indexation and Price Recalculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../package_manager.html">Extensions and Package Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../processes.html">Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../jobs.html">Job Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cron.html">Scheduled Tasks via Cron</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../monitoring/index.html">Healthcheck and Data Monitoring</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../configuration_guide/index.html">Configuration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../community/index.html">Community Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../system_requirements.html">System Requirements</a></li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Oro Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="../../../_sources/admin_guide/op_structure/search_index/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>