<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>How to Replace Inline-Javascript with a Component &#8212; OroCommerce 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Web Services API" href="../integration/index.html" />
    <link rel="prev" title="How to Create a Global JavaScript Component" href="how_to_create_global_js_component.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

<script language="javascript" type="text/javascript">
    <!--
    var materialdropdown = document.querySelector('.material-dropdown'),
    middle = document.querySelector('.middle'),
    cross = document.querySelector('.cross'),
    dropdown = document.querySelector('.dropdown');

materialdropdown.addEventListener('click', function() {
  middle.classList.toggle('active');
  cross.classList.toggle('active');
  dropdown.classList.toggle('active');
})
    -->
  </script>
    


  </head>
  <body role="document">
  

    <div class="document">
<div class="header">
    <div class="main-nav">
        <nav class="navbar navbar-default navbar-fixed-top">
            <div id="nav-menu" class="navbar-top">
                <div class="nav-container">
                    <div class="navbar-header">
                        <a href="https://www.orocommerce.com/"
                           class="navbar-brand"><img
                                src="https://www.orocommerce.com/wp-content/themes/commerce/images/orocommerce_logo.svg"
                                alt="Open Source B2B eCommerce Platform - OroCommerce"></a>
                    </div>
                    <div class="navbar-header">
                        <p class="navbar-header" href="#">Documentation for... </p>
                    </div>
                    <div id="navbar" class="navbar-left">
                        <div class="navbar-collapse collapse">
                            <div class="menu-header-menu-container">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/index.html">All Users</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/getting_started/index.html">Getting Started with UI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/inventory/index.html">Warehouses and Inventory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/customers/index.html">Customers and Customer Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/quotes/index.html">Quotes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/payment/index.html">Payment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/shipping/index.html">Shipping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/marketing_web_catalog/index.html">Web Catalogs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/marketing_landing_pages/index.html">Landing Pages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../seo_config_guide/index.html">SEO Configuration Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/taxes/index.html">Taxes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/segments/index.html">Segments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/system/index.html">System Configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../frontstore_guide/index.html">B2B Buyer</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../frontstore_guide/getting_started/index.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../frontstore_guide/navigation/index.html">Navigation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../frontstore_guide/profile/index.html">My Profile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../frontstore_guide/users_roles/index.html">My Organization Users and Roles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../frontstore_guide/orders/index.html">Orders</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../frontstore_guide/rfq/index.html">Request for Quote</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../frontstore_guide/quotes/index.html">Quotes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../frontstore_guide/shopping_lists/index.html">Shopping Lists</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../seo_config_guide/index.html">SEO</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../seo_config_guide/website/index.html">Website Configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../admin_guide/index.html">Admin</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../admin_guide/price_list_sharding.html">How to Configure Price List Sharding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../admin_guide/optimize_index_and_price_calculation.html">Optimize Website Indexation and Price Recalculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../system_requirements.html">System Requirements</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Developer</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../basics/index.html">OroPlatform Architecture</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Customizing Oro Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integration/index.html">Web Services API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theme/index.html">Customizing the Theme</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install_upgrade_and_patch/index.html">Extension and Patch Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/index.html">Annotation and Configuration Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entities/index.html">Using and Managing Entities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../other/index.html">How to... Articles</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../community/index.html">Community</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../community/contribute.html">Contributing to Oro Source Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../community/translations.html">Contributing to Translatiion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../community/write.html">Contributing to Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../community/issues/index.html">Contacting Support and Reporting Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../community/question.html">Submitting a Question</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../community/release.html">Release Process</a></li>
</ul>
</li>
</ul>


                                <!--
                                <ul class="nav">
                                    <li><a href="#">Installation</a></li>
                                    <li><a href="#">Configuration</a></li>
                                    <li><a href="#">Use <i class="fa fa-search search-complete__icon"></i></a>
                                        <ul class="sub-nav">
                                            <li class="sub-menu" ><a href="#">HTML</a>
                                            </li>
                                            <li class="sub-menu" ><a
                                                   href="#">CSS</a>
                                                <ul class="sub-nav">
                                                    <li class="sub-menu"><a
                                                           href="#">Resets</a>
                                                    </li>
                                                    <li class="sub-menu"><a
                                                           href="#">Grids</a>
                                                    </li>
                                                    <li class="sub-menu"><a
                                                           href="#">Frameworks</a>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li><a class="sub-menu" href="#">Development</a>
                                                <ul class="sub-nav">
                                                    <li class="sub-menu"><a
                                                           href="#">Ajax</a>
                                                    </li>
                                                    <li class="sub-menu"><a
                                                           href="#">jQuery</a>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a href="#">Contribution</a>
                                        <ul class="sub-nav">
                                            <li class="sub-menu"><a href="#">Themes</a>
                                            </li>
                                            <li class="sub-menu"><a href="#">Plugins</a>
                                            </li>
                                            <li class="sub-menu"><a href="#">Custom
                                                Post Types</a>
                                                <ul class="sub-nav">
                                                    <li class="sub-menu"><a
                                                           href="#">Portfolios</a>
                                                    </li>
                                                    <li class="sub-menu"><a
                                                           href="#">Testimonials</a>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li class="sub-menu"><a href="#">Options</a>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                                -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </nav>
    </div>
</div>


      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="how-to-replace-inline-javascript-with-a-component">
<h1>How to Replace Inline-Javascript with a Component<a class="headerlink" href="#how-to-replace-inline-javascript-with-a-component" title="Permalink to this headline">¶</a></h1>
<div class="section" id="embedding-functionality-in-a-page">
<h2>Embedding Functionality in a Page<a class="headerlink" href="#embedding-functionality-in-a-page" title="Permalink to this headline">¶</a></h2>
<p>Commonly, inline JavaScript is used to bind some interactive functionality into the particular markup
fragment:</p>
<div class="highlight-html"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">select</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;my-select&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">option</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;foo&quot;</span><span class="p">&gt;</span>Foo<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">option</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;bar&quot;</span><span class="p">&gt;</span>Bar<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span><span class="p">&gt;</span>
    <span class="nx">require</span><span class="p">([</span><span class="s1">&#39;jquery&#39;</span><span class="p">,</span> <span class="s1">&#39;jquery.select2&#39;</span><span class="p">],</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#my-select&#39;</span><span class="p">).</span><span class="nx">select2</span><span class="p">({</span>
            <span class="nx">placeholder</span><span class="o">:</span> <span class="s1">&#39;Select one ...&#39;</span><span class="p">,</span>
            <span class="nx">allowClear</span><span class="o">:</span> <span class="kc">true</span>
        <span class="p">});</span>
    <span class="p">});</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table></div>
<p>Inline scripts are often larger than in the example above and may also make use of inline Twig code.
It is impossible to reuse this code, extend it or test it. Additionally, it&#8217;s hard to maintain it.</p>
<p>Furthermore, the lifecycle of its instances is not defined and it is not specified how the function
will be disabled when the control is not used anymore. Instead, one has to rely on jQuery to
properly clean the memory. Most of the time, jQuery does this fine. However, there&#8217;s no
guarantee that jQuery would always handle this task successfully without developer&#8217;s help.</p>
<p>The solution for the problems explained above is a Page Component.</p>
</div>
<div class="section" id="a-page-component">
<h2>A Page Component<a class="headerlink" href="#a-page-component" title="Permalink to this headline">¶</a></h2>
<p>A Page Component is a controller that is used to implement certain parts of the page functionality.
It is responsible for the following things:</p>
<blockquote>
<div><ul class="simple">
<li>creating related views, collections, models and even sub-components</li>
<li>handling environment events</li>
<li>disposing obsolete instances</li>
</ul>
</div></blockquote>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">You can find more information about Page Components in the
<a class="reference internal" href="../basics/frontend_architecture.html"><span class="doc">Frontend Architecture section</span></a> and in the
<a class="reference external" href="https://github.com/orocrm/platform/blob/master/src/Oro/Bundle/UIBundle/Resources/doc/reference/page-component.md">Page Component documentation</a>.</p>
</div>
</div>
<div class="section" id="creating-a-page-component">
<h2>Creating a Page Component<a class="headerlink" href="#creating-a-page-component" title="Permalink to this headline">¶</a></h2>
<p>A Page Component is a JavaScript object based on the <code class="docutils literal"><span class="pre">BaseComponent</span></code>. The inline JavaScript from
the introduction will be replaced by the new <code class="docutils literal"><span class="pre">Select2Component</span></code>. Start with creating the <code class="docutils literal"><span class="pre">select2-component.js</span></code>
file that lives in the <code class="docutils literal"><span class="pre">Resources/public/js/app/components</span></code> directory of your bundle.</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// src/Acme/DemoBundle/Resources/public/js/app/components/select2-component.js</span>
<span class="nx">define</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">require</span><span class="p">)</span> <span class="p">{</span>
    <span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">Select2Component</span><span class="p">,</span>
        <span class="nx">BaseComponent</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;oroui/js/app/components/base/component&#39;</span><span class="p">);</span>
    <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;jquery.select2&#39;</span><span class="p">);</span>

    <span class="nx">Select2Component</span> <span class="o">=</span> <span class="nx">BaseComponent</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="cm">/**</span>
<span class="cm">         * Initializes Select2 component</span>
<span class="cm">         *</span>
<span class="cm">         * @param {Object} options</span>
<span class="cm">         */</span>
        <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// _sourceElement refers to the HTMLElement</span>
            <span class="c1">// that contains the component declaration</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">$elem</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">_sourceElement</span><span class="p">;</span>
            <span class="k">delete</span> <span class="nx">options</span><span class="p">.</span><span class="nx">_sourceElement</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">$elem</span><span class="p">.</span><span class="nx">select2</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>
            <span class="nx">Select2Component</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">initialize</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="cm">/**</span>
<span class="cm">         * Disposes the component</span>
<span class="cm">         */</span>
        <span class="nx">dispose</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">disposed</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// component is already removed</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">$elem</span><span class="p">.</span><span class="nx">select2</span><span class="p">(</span><span class="s1">&#39;destroy&#39;</span><span class="p">);</span>
            <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">$elem</span><span class="p">;</span>
            <span class="nx">Select2Component</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">dispose</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">Select2Component</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>
</td></tr></table></div>
<p>This code can be tested, extended and reused. What&#8217;s even more important is that the component
provides two methods <code class="docutils literal"><span class="pre">initialize()</span></code> and <code class="docutils literal"><span class="pre">dispose()</span></code> which restrict the existence of the
<code class="docutils literal"><span class="pre">select2</span></code> instance. Thus, it defines its own lifesycle and therefore minimizes the risk of
memory leaks.</p>
</div>
<div class="section" id="declaring-a-page-component-in-html">
<h2>Declaring a Page Component in HTML<a class="headerlink" href="#declaring-a-page-component-in-html" title="Permalink to this headline">¶</a></h2>
<p>Next, the HTML code of the related template has to be modified to tell the <code class="docutils literal"><span class="pre">Layout</span></code> which
HTML elements are related to the <code class="docutils literal"><span class="pre">Select2Component</span></code> component:</p>
<div class="highlight-html+jinja"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">set</span> <span class="nv">options</span> <span class="o">=</span> <span class="o">{</span>
    <span class="nv">placeholder</span><span class="o">:</span> <span class="s1">&#39;Select one ...&#39;</span><span class="o">,</span>
    <span class="nv">allowClear</span><span class="o">:</span> <span class="kp">true</span>
<span class="o">}</span> <span class="cp">%}</span>

<span class="c">{# assign the component module name and initialization options to HTML #}</span>
<span class="p">&lt;</span><span class="nt">select</span>
    <span class="na">data-page-component-module</span><span class="o">=</span><span class="s">&quot;acmedemo/js/app/components/select2-component&quot;</span>
    <span class="na">data-page-component-options</span><span class="o">=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">options</span><span class="o">|</span><span class="nf">json_encode</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">option</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;foo&quot;</span><span class="p">&gt;</span>Foo<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">option</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;bar&quot;</span><span class="p">&gt;</span>Bar<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table></div>
<p>The <code class="docutils literal"><span class="pre">Layout</span></code> uses two attributes to resolve the Component module associated with an HTML element
when <code class="docutils literal"><span class="pre">layout:init</span></code> is executed by the <a class="reference external" href="https://github.com/orocrm/platform/blob/master/src/Oro/Bundle/UIBundle/Resources/public/js/app/controllers/page-controller.js">PageController</a>:</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">data-page-component-module</span></code></dt>
<dd>The name of the module</dd>
<dt><code class="docutils literal"><span class="pre">data-page-component-options</span></code></dt>
<dd>A JSON encoded string containing module configuration options</dd>
</dl>
<p>Once this HTML code is injected into the document, the <code class="docutils literal"><span class="pre">PageController</span></code> will execute the
<code class="docutils literal"><span class="pre">layout:init</span></code> handler and the component will be initialized.</p>
</div>
<div class="section" id="using-the-view-component">
<h2>Using the View Component<a class="headerlink" href="#using-the-view-component" title="Permalink to this headline">¶</a></h2>
<p>The code is now reusable. Though it can be improved by separating business logic from the view
layer. Therefore, replace the <code class="docutils literal"><span class="pre">Select2Component</span></code> with the <code class="docutils literal"><span class="pre">Select2View</span></code> class in the file named
<code class="docutils literal"><span class="pre">select2-view.js</span></code> that lives in the <code class="docutils literal"><span class="pre">Resources/public/js/app/views</span></code> directory of your bundle
and that extends the <code class="docutils literal"><span class="pre">BaseView</span></code> class:</p>
<div class="highlight-javascript"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// src/Acme/DemoBundle/Resources/public/js/app/views/select2-view.js</span>
<span class="nx">define</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">require</span><span class="p">)</span> <span class="p">{</span>
    <span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">Select2View</span><span class="p">,</span>
        <span class="nx">BaseView</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;oroui/js/app/views/base/view&#39;</span><span class="p">);</span>
    <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;jquery.select2&#39;</span><span class="p">);</span>

    <span class="nx">Select2View</span> <span class="o">=</span> <span class="nx">BaseView</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">autoRender</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>

        <span class="cm">/**</span>
<span class="cm">         * Renders a select2 view</span>
<span class="cm">         */</span>
        <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">select2</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">);</span>
            <span class="k">return</span> <span class="nx">Select2View</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">render</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="p">},</span>

        <span class="cm">/**</span>
<span class="cm">         * Disposes the view</span>
<span class="cm">         */</span>
        <span class="nx">dispose</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">disposed</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// the view is already removed</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">select2</span><span class="p">(</span><span class="s1">&#39;destroy&#39;</span><span class="p">);</span>
            <span class="nx">Select2View</span><span class="p">.</span><span class="nx">__super__</span><span class="p">.</span><span class="nx">dispose</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="k">return</span> <span class="nx">Select2View</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>
</td></tr></table></div>
<p>This looks pretty much like the initially created <code class="docutils literal"><span class="pre">Select2Component</span></code> except that you don&#8217;t have
to deal with retrieving the associated HTML element and that you don&#8217;t have to parse the options.
This is done for you by the <code class="docutils literal"><span class="pre">ViewComponent</span></code>.</p>
<p>However, you still need to tell the component to instantiate your <code class="docutils literal"><span class="pre">Select2View</span></code>. For this purpose
OroPlatform is shipped with the <code class="docutils literal"><span class="pre">ViewComponent</span></code> that instantiates views for HTML elements.
To make use of the <code class="docutils literal"><span class="pre">ViewComponent</span></code>, replace the value of <code class="docutils literal"><span class="pre">data-page-component-module</span></code> attribute
with the <code class="docutils literal"><span class="pre">oroui/js/app/components/view-component</span></code> and use the <code class="docutils literal"><span class="pre">view</span></code> option to point to your new
<code class="docutils literal"><span class="pre">Select2View</span></code>:</p>
<div class="highlight-html+jinja"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">set</span> <span class="nv">options</span> <span class="o">=</span> <span class="o">{</span>
    <span class="nv">view</span><span class="o">:</span> <span class="s1">&#39;acmedemo/js/app/views/select2-view&#39;</span><span class="o">,</span>
    <span class="nv">placeholder</span><span class="o">:</span> <span class="s1">&#39;Select one ...&#39;</span><span class="o">,</span>
    <span class="nv">allowClear</span><span class="o">:</span> <span class="kp">true</span>
<span class="o">}</span> <span class="cp">%}</span>

<span class="c">{# assign the component module name and initialization options to the HTML #}</span>
<span class="p">&lt;</span><span class="nt">select</span>
    <span class="na">data-page-component-module</span><span class="o">=</span><span class="s">&quot;oroui/js/app/components/view-component&quot;</span>
    <span class="na">data-page-component-options</span><span class="o">=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">options</span><span class="o">|</span><span class="nf">json_encode</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">option</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;foo&quot;</span><span class="p">&gt;</span>Foo<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">option</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;bar&quot;</span><span class="p">&gt;</span>Bar<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table></div>
<p>The <code class="docutils literal"><span class="pre">ViewComponent</span></code> loads the required module, fetches the <code class="docutils literal"><span class="pre">view</span></code> and the <code class="docutils literal"><span class="pre">_sourceElement</span></code>
from the options and instantiates the View instance. This View instance is attached to the
component instance. Once the component gets disposed, it automatically invokes the <code class="docutils literal"><span class="pre">dispose()</span></code>
methods of all attached instances (if the <code class="docutils literal"><span class="pre">dispose()</span></code> method was defined for the instance).</p>
<p>Please note that as we instantiate the view in the module load callback,
we deal with asynchronous process. Therefore, the component is not ready for use right after
the initialization method has finished its work. We need to inform the super controller that
this is async initialization. To do so, we first call <code class="docutils literal"><span class="pre">this._deferredInit()</span></code>
that creates a promise object, and once the initialization is over, we invoke
<code class="docutils literal"><span class="pre">this._resolveDeferredInit()</span></code> that resolves this promise. This way the
super controller gets informed that the component is initialized.</p>
</div>
<div class="section" id="configure-requirejs">
<h2>Configure RequireJS<a class="headerlink" href="#configure-requirejs" title="Permalink to this headline">¶</a></h2>
<p>Finally, you need to make your new classes known to RequireJS:</p>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># src/Acme/DemoBundle/Resources/config/requirejs.yml</span>
<span class="l l-Scalar l-Scalar-Plain">config</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">paths</span><span class="p p-Indicator">:</span>
        <span class="c1"># for the Select2View class</span>
        <span class="s">&#39;acmedemo/js/app/views/select2-view&#39;</span><span class="p p-Indicator">:</span> <span class="s">&#39;bundles/acmeui/js/app/views/select2-view.js&#39;</span>
        <span class="c1"># for the Select2Component class</span>
        <span class="s">&#39;acmedemo/js/app/components/select2-component&#39;</span><span class="p p-Indicator">:</span> <span class="s">&#39;bundles/acmeui/js/app/components/select2-component.js&#39;</span>
</pre></div>
</td></tr></table></div>
<p>Whether you have created your own component or a view (that is instantiated by the ViewComponent),
you&#8217;ll have to add the module name into RequireJS configuration, so that it can trace this module
and include it into the build file.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>To see your component in action, you need to do several more things:</p>
<ul class="last">
<li><p class="first">Clear the Symfony application cache to update the cache and the included RequireJS config:</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ php app/console cache:clear
</pre></div>
</td></tr></table></div>
</li>
<li><p class="first">Reinstall your assets if you don&#8217;t deploy them via symlinks:</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ php app/console oro:assets:install
</pre></div>
</td></tr></table></div>
</li>
<li><p class="first">In production mode, you also have to rebuild the JavaScript code:</p>
<div class="highlight-bash"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>$ php app/console oro:requirejs:build
</pre></div>
</td></tr></table></div>
</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<ul>
<li><a class="reference internal" href="#">How to Replace Inline-Javascript with a Component</a><ul>
<li><a class="reference internal" href="#embedding-functionality-in-a-page">Embedding Functionality in a Page</a></li>
<li><a class="reference internal" href="#a-page-component">A Page Component</a></li>
<li><a class="reference internal" href="#creating-a-page-component">Creating a Page Component</a></li>
<li><a class="reference internal" href="#declaring-a-page-component-in-html">Declaring a Page Component in HTML</a></li>
<li><a class="reference internal" href="#using-the-view-component">Using the View Component</a></li>
<li><a class="reference internal" href="#configure-requirejs">Configure RequireJS</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Developer Guide</a><ul>
  <li><a href="index.html">Customizing Oro Features</a><ul>
      <li>Previous: <a href="how_to_create_global_js_component.html" title="previous chapter">How to Create a Global JavaScript Component</a></li>
      <li>Next: <a href="../integration/index.html" title="next chapter">Web Services API</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
    <form class="search" action="../../search.html" method="get">
      <div><i class="fa fa-search search-complete__icon"></i>&nbsp;<input class="search_text" type="text" placeholder="Search in documentation " name="q" />
      <input class="submit" type="submit" value="Search" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Oro Inc. All rights reserved.
           
      
    </div>

    

    
  </body>
</html>