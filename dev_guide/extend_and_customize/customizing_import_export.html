<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Extending Entities to Support Bulk Import and Export &#8212; OroCommerce 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="How to Add an Extension to the OroCRM Marketplace" href="how_to_add_an_extension_to_oro_marketplace.html" />
    <link rel="prev" title="Customizing CRUD Pages" href="customizing_crud.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="extending-entities-to-support-bulk-import-and-export">
<h1>Extending Entities to Support Bulk Import and Export<a class="headerlink" href="#extending-entities-to-support-bulk-import-and-export" title="Permalink to this headline">¶</a></h1>
<p>Import/export capabilities in Oro applications are available for most critical features where the daily operations generate high data load. Bulk import is recommented when manual one-by-one entry is not efficient.</p>
<p>Out of the box, import and export is enabled for the following types of data:</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="37%" />
<col width="30%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">OroCommerce</th>
<th class="head">OroCRM</th>
<th class="head">OroPlatform</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Products</td>
<td>Leads</td>
<td>Emails</td>
</tr>
<tr class="row-odd"><td>Price lists</td>
<td>Opportunities</td>
<td>Integrations</td>
</tr>
<tr class="row-even"><td>Inventory levels</td>
<td>Accounts</td>
<td>Localizations</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>Contacts</td>
<td>Languages</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>Business Customers</td>
<td>Users</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
<td>Organizations</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
<td>User Groups</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
<td>User Roles</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
<td>Business Units</td>
</tr>
</tbody>
</table>
<p>When your business calls for a non-standard solution, you may customize Oro application and enable import/export for the entity that is not listed above. This works for your custom entities or for the standard one that is heavily used in your business.</p>
<div class="section" id="how-to-enable-import-export-for-a-custom-entity">
<h2>How to enable import/export for a custom entity<a class="headerlink" href="#how-to-enable-import-export-for-a-custom-entity" title="Permalink to this headline">¶</a></h2>
<p>To make Oro Platform capable to export your custom entities as CSV files and to be able to load data from CSV files for your entities, create the following methods, services and configurations:</p>
<ul class="simple">
<li><a class="reference internal" href="#implement-configuration-loading-method">Implement Configuration Loading Method</a></li>
<li><a class="reference internal" href="#configure-import-and-export-services-processors">Configure Import and Export Services (Processors)</a></li>
<li><a class="reference internal" href="#prepare-import-data-template">Prepare Import Data Template</a></li>
<li><a class="reference internal" href="#enable-import-and-export-in-the-ui">Enable Import and Export in the UI</a></li>
</ul>
<div class="section" id="implement-configuration-loading-method">
<h3>Implement Configuration Loading Method<a class="headerlink" href="#implement-configuration-loading-method" title="Permalink to this headline">¶</a></h3>
<p>To enable Oro application read configuration settings from the configuration files, add a container
extension class in the entity bundle and implement the <em>load</em> method, like in the example below:</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// src/AppBundle/DependencyInjection/AppExtension.php</span>
<span class="k">namespace</span> <span class="nx">AppBundle\DependencyInjection</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Symfony\Component\Config\FileLocator</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\DependencyInjection\ContainerBuilder</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\DependencyInjection\Extension\Extension</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\DependencyInjection\Loader\YamlFileLoader</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">AppExtension</span> <span class="k">extends</span> <span class="nx">Extension</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">load</span><span class="p">(</span><span class="k">array</span> <span class="nv">$configs</span><span class="p">,</span> <span class="nx">ContainerBuilder</span> <span class="nv">$container</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$loader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">YamlFileLoader</span><span class="p">(</span><span class="nv">$container</span><span class="p">,</span> <span class="k">new</span> <span class="nx">FileLocator</span><span class="p">(</span><span class="no">__DIR__</span><span class="o">.</span><span class="s1">&#39;/Resources/config&#39;</span><span class="p">));</span>
        <span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">load</span><span class="p">(</span><span class="s1">&#39;importexport.yml&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>In this example, the <em>importexport.yml</em> file is located in the <em>Resources/config</em> directory of the bundle.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is recommended to keep the default location and default filename for the import/export configuration file.</p>
</div>
</div>
<div class="section" id="configure-import-and-export-services-processors">
<h3>Configure Import and Export Services (Processors)<a class="headerlink" href="#configure-import-and-export-services-processors" title="Permalink to this headline">¶</a></h3>
<p>In Oro Platform, import and export processor are implemented in the <code class="docutils literal"><a class="reference external" href="http://phpdoc.orocrm.com/platform/classes/Oro.Bundle.ImportExportBundle.Processor.ImportProcessor.html" title="Oro\Bundle\ImportExportBundle\Processor\ImportProcessor"><span class="pre">ImportProcessor</span></a></code> and
<code class="docutils literal"><a class="reference external" href="http://phpdoc.orocrm.com/platform/classes/Oro.Bundle.ImportExportBundle.Processor.ExportProcessor.html" title="Oro\Bundle\ImportExportBundle\Processor\ExportProcessor"><span class="pre">ExportProcessor</span></a></code> classes that ship with the
OroImportExportBundle.</p>
<p>In the <em>importexport.yml</em> configuration file located in the <em>Resources/config</em> directory, define the secrvices that are based on the on abstract OroImportExportBundle services, like in the following example:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the tags section, specify the entity to enable import/export for.</p>
</div>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">src/AppBundle/Resources/config/importexport.yml</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">services</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">app.importexport.data_converter</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">parent</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">oro_importexport.data_converter.configurable</span>

    <span class="l l-Scalar l-Scalar-Plain">app.importexport.processor.export</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">parent</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">oro_importexport.processor.export_abstract</span>
        <span class="l l-Scalar l-Scalar-Plain">calls</span><span class="p p-Indicator">:</span>
            <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">setDataConverter</span><span class="p p-Indicator">,</span> <span class="p p-Indicator">[</span><span class="s">&#39;@app.importexport.data_converter&#39;</span><span class="p p-Indicator">]]</span>
        <span class="l l-Scalar l-Scalar-Plain">tags</span><span class="p p-Indicator">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">oro_importexport.processor</span>
              <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">export</span>
              <span class="l l-Scalar l-Scalar-Plain">entity</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">AppBundle\Entity\Task</span>
              <span class="l l-Scalar l-Scalar-Plain">alias</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">app_task</span>
    <span class="l l-Scalar l-Scalar-Plain">app.importexport.processor.import</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">parent</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">oro_importexport.processor.import_abstract</span>
        <span class="l l-Scalar l-Scalar-Plain">calls</span><span class="p p-Indicator">:</span>
            <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">setDataConverter</span><span class="p p-Indicator">,</span> <span class="p p-Indicator">[</span><span class="s">&#39;@app.importexport.data_converter&#39;</span><span class="p p-Indicator">]]</span>
        <span class="l l-Scalar l-Scalar-Plain">tags</span><span class="p p-Indicator">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">oro_importexport.processor</span>
              <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">import</span>
              <span class="l l-Scalar l-Scalar-Plain">entity</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">AppBundle\Entity\Task</span>
              <span class="l l-Scalar l-Scalar-Plain">alias</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">app_task</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="prepare-import-data-template">
<h3>Prepare Import Data Template<a class="headerlink" href="#prepare-import-data-template" title="Permalink to this headline">¶</a></h3>
<p>Import capability in Oro applications is documented with a Data Template - a sample import file that illustrates expected structure of the data, like the headers, data types, and acceptable values that are valid for the entity attributes.</p>
<p>User can download data template in a csv format from the list next to the Import option. Oro application creates a file automatically based on the related template fixtures.</p>
<p>To implement these fixtures for your custom entity, create a class that implements TemplateFixtureInterface and extends AbstractTemplateRepository and implement the following methods:</p>
<ul class="simple">
<li><em>getEntityClass()</em></li>
<li><em>getData()</em></li>
<li><em>fillEntityData($key, $entity)</em></li>
<li><em>createEntity($key)</em></li>
</ul>
<p>In the <em>fillEntityData</em> method, populate the values for the attributes that shall be included into the template.</p>
<p>Please refer to the following example:</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// src/AppBundle/ImportExport/TemplateFixture;</span>
<span class="k">namespace</span> <span class="nx">AppBundle\ImportExport\TemplateFixture</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">AppBundle\Entity\Task</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Oro\Bundle\ImportExportBundle\TemplateFixture\AbstractTemplateRepository</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Oro\Bundle\ImportExportBundle\TemplateFixture\TemplateFixtureInterface</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">TaskFixture</span> <span class="k">extends</span> <span class="nx">AbstractTemplateRepository</span> <span class="k">implements</span> <span class="nx">TemplateFixtureInterface</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getEntityClass</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="s1">&#39;AppBundle\Entity\Task&#39;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">getData</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getEntityData</span><span class="p">(</span><span class="s1">&#39;example-task&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">fillEntityData</span><span class="p">(</span><span class="nv">$key</span><span class="p">,</span> <span class="nv">$entity</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$entity</span><span class="o">-&gt;</span><span class="na">setId</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="nv">$entity</span><span class="o">-&gt;</span><span class="na">setSubject</span><span class="p">(</span><span class="s1">&#39;Call customer&#39;</span><span class="p">);</span>
        <span class="nv">$entity</span><span class="o">-&gt;</span><span class="na">setDescription</span><span class="p">(</span><span class="s1">&#39;Please call the customer to talk about their future plans.&#39;</span><span class="p">);</span>
        <span class="nv">$entity</span><span class="o">-&gt;</span><span class="na">setDueDate</span><span class="p">(</span><span class="k">new</span> <span class="nx">\DateTime</span><span class="p">(</span><span class="s1">&#39;+3 days&#39;</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">protected</span> <span class="k">function</span> <span class="nf">createEntity</span><span class="p">(</span><span class="nv">$key</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">Task</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Next, in the <em>importexport.yml</em> file located in the <em>src/AppBundle/Resources/config/ folder</em>, register the newly created fixtures class as a service. Please refer to the following example:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">src/AppBundle/Resources/config/importexport.yml</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">services</span><span class="p p-Indicator">:</span>
    <span class="c1"># ...</span>

    <span class="l l-Scalar l-Scalar-Plain">app.importexport.template_fixture.task</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">class</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">AppBundle\ImportExport\TemplateFixture\TaskFixture</span>
        <span class="l l-Scalar l-Scalar-Plain">tags</span><span class="p p-Indicator">:</span>
            <span class="p p-Indicator">-</span> <span class="p p-Indicator">{</span> <span class="nv">name</span><span class="p p-Indicator">:</span> <span class="nv">oro_importexport.template_fixture</span> <span class="p p-Indicator">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="enable-import-and-export-in-the-ui">
<h3>Enable Import and Export in the UI<a class="headerlink" href="#enable-import-and-export-in-the-ui" title="Permalink to this headline">¶</a></h3>
<p>To enable export and import for Oro application users, reuse the <code class="docutils literal"><span class="pre">buttons.html.twig</span></code> template from the
OroImportExportBundle. Include it into the twig template in the navigation block (<em>block navButtons</em>). Provide the valid entity_class, export and import processor aliases from the configuration file that is described in the <a class="reference internal" href="#configure-import-and-export-services-processors">Configure import and export services (processors)</a> section.</p>
<div class="highlight-html+jinja"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">{# src/AppBundle/Resources/views/Task/index.html.twig #}</span>
<span class="cp">{%</span> <span class="k">extends</span> <span class="s1">&#39;OroUIBundle:actions:index.html.twig&#39;</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">set</span> <span class="nv">gridName</span> <span class="o">=</span> <span class="s1">&#39;app-tasks-grid&#39;</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">set</span> <span class="nv">pageTitle</span> <span class="o">=</span> <span class="s1">&#39;Task&#39;</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">navButtons</span> <span class="cp">%}</span>
    <span class="cp">{%</span> <span class="k">include</span> <span class="s1">&#39;OroImportExportBundle:ImportExport:buttons.html.twig&#39;</span> <span class="k">with</span> <span class="o">{</span>
        <span class="nv">entity_class</span><span class="o">:</span> <span class="s1">&#39;AppBundle\\Entity\\Task&#39;</span><span class="o">,</span>
        <span class="nv">exportProcessor</span><span class="o">:</span> <span class="s1">&#39;app_task&#39;</span><span class="o">,</span>
        <span class="nv">exportTitle</span><span class="o">:</span> <span class="s1">&#39;Export&#39;</span><span class="o">,</span>
        <span class="nv">importProcessor</span><span class="o">:</span> <span class="s1">&#39;app_task&#39;</span><span class="o">,</span>
        <span class="nv">importTitle</span><span class="o">:</span> <span class="s1">&#39;Import&#39;</span><span class="o">,</span>
        <span class="nv">datagridName</span><span class="o">:</span> <span class="nv">gridName</span>
    <span class="o">}</span> <span class="cp">%}</span>

    <span class="c">{# ... #}</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../../index.html">Table Of Contents</a></h3>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/dev_guide/extend_and_customize/customizing_import_export.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Developer Guide</a><ul>
  <li><a href="index.html">Customizing Oro Features</a><ul>
      <li>Previous: <a href="customizing_crud.html" title="previous chapter">Customizing CRUD Pages</a></li>
      <li>Next: <a href="how_to_add_an_extension_to_oro_marketplace.html" title="next chapter">How to Add an Extension to the OroCRM Marketplace</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Oro Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="../../_sources/dev_guide/extend_and_customize/customizing_import_export.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>