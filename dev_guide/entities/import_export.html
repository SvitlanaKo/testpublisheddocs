<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>How to Import and Export Entities &#8212; OroCommerce 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="How to Create a Report" href="report.html" />
    <link rel="prev" title="How to Protect Entities Using ACLs" href="acls.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
<div class="header">
    <div class="main-nav">
        <nav class="navbar navbar-default navbar-fixed-top">
            <div id="nav-menu" class="navbar-top">
                <div class="nav-container">
                    <div class="navbar-header">
                        <a href="https://www.orocommerce.com/"
                           class="navbar-brand"><img
                                src="https://www.orocommerce.com/wp-content/themes/commerce/images/orocommerce_logo.svg"
                                alt="Open Source B2B eCommerce Platform - OroCommerce"></a>
                    </div>
                    <div class="navbar-header">
                        <p class="navbar-header" href="#">Documentation</p>
                    </div>
                    <div class="navbar-right">
                        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="report.html" title="How to Create a Report"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="acls.html" title="How to Protect Entities Using ACLs"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Developer Guide</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">Using and Managing Entities</a> &#187;</li> 
     <li class="nav-item nav-item-this">How to Import and Export Entities</li>
      </ul>
    </div>
                    </div>

                </div>
            </div>

        </nav>
    </div>
</div>


      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="how-to-import-and-export-entities">
<h1>How to Import and Export Entities<a class="headerlink" href="#how-to-import-and-export-entities" title="Permalink to this headline">¶</a></h1>
<p>You have to create some services and add some configuration to make Oro Platform capable to export
your custom entities as CSV files and to be able to load data from CSV files for your entities.</p>
<p>All the configuration described below will be added to the <code class="docutils literal"><span class="pre">importexport.yml</span></code> file in the
<code class="docutils literal"><span class="pre">Resources/config</span></code> directory of your application bundle. Make sure that you have a container
extension class in your bundle that loads the configuration file:</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// src/AppBundle/DependencyInjection/AppExtension.php</span>
<span class="k">namespace</span> <span class="nx">AppBundle\DependencyInjection</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Symfony\Component\Config\FileLocator</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\DependencyInjection\ContainerBuilder</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\DependencyInjection\Extension\Extension</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Symfony\Component\DependencyInjection\Loader\YamlFileLoader</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">AppExtension</span> <span class="k">extends</span> <span class="nx">Extension</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">load</span><span class="p">(</span><span class="k">array</span> <span class="nv">$configs</span><span class="p">,</span> <span class="nx">ContainerBuilder</span> <span class="nv">$container</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$loader</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">YamlFileLoader</span><span class="p">(</span><span class="nv">$container</span><span class="p">,</span> <span class="k">new</span> <span class="nx">FileLocator</span><span class="p">(</span><span class="no">__DIR__</span><span class="o">.</span><span class="s1">&#39;/Resources/config&#39;</span><span class="p">));</span>
        <span class="nv">$loader</span><span class="o">-&gt;</span><span class="na">load</span><span class="p">(</span><span class="s1">&#39;importexport.yml&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="setting-up-the-import-and-export-processor">
<h2>Setting Up the Import and Export Processor<a class="headerlink" href="#setting-up-the-import-and-export-processor" title="Permalink to this headline">¶</a></h2>
<p>Import and export is handled by so called processors which transform the imported data into actual
entities and vice versa. The easiest way to quickly set up import and export processors for your
entities is to reuse the <code class="docutils literal"><a class="reference external" href="http://phpdoc.orocrm.com/platform/classes/Oro.Bundle.ImportExportBundle.Processor.ImportProcessor.html" title="Oro\Bundle\ImportExportBundle\Processor\ImportProcessor"><span class="pre">ImportProcessor</span></a></code> and
<code class="docutils literal"><a class="reference external" href="http://phpdoc.orocrm.com/platform/classes/Oro.Bundle.ImportExportBundle.Processor.ExportProcessor.html" title="Oro\Bundle\ImportExportBundle\Processor\ExportProcessor"><span class="pre">ExportProcessor</span></a></code> classes that ship with the
OroImportExportBundle. All you need to do is creating services that are based on abstract services
from the OroImportExportBundle and let them know which entity class they have to handle:</p>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># src/AppBundle/Resources/config/importexport.yml</span>
<span class="l l-Scalar l-Scalar-Plain">services</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">app.importexport.data_converter</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">parent</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">oro_importexport.data_converter.configurable</span>

    <span class="l l-Scalar l-Scalar-Plain">app.importexport.processor.export</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">parent</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">oro_importexport.processor.export_abstract</span>
        <span class="l l-Scalar l-Scalar-Plain">calls</span><span class="p p-Indicator">:</span>
            <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">setDataConverter</span><span class="p p-Indicator">,</span> <span class="p p-Indicator">[</span><span class="s">&#39;@app.importexport.data_converter&#39;</span><span class="p p-Indicator">]]</span>
        <span class="l l-Scalar l-Scalar-Plain">tags</span><span class="p p-Indicator">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">oro_importexport.processor</span>
              <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">export</span>
              <span class="l l-Scalar l-Scalar-Plain">entity</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">AppBundle\Entity\Task</span>
              <span class="l l-Scalar l-Scalar-Plain">alias</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">app_task</span>
    <span class="l l-Scalar l-Scalar-Plain">app.importexport.processor.import</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">parent</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">oro_importexport.processor.import_abstract</span>
        <span class="l l-Scalar l-Scalar-Plain">calls</span><span class="p p-Indicator">:</span>
            <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="nv">setDataConverter</span><span class="p p-Indicator">,</span> <span class="p p-Indicator">[</span><span class="s">&#39;@app.importexport.data_converter&#39;</span><span class="p p-Indicator">]]</span>
        <span class="l l-Scalar l-Scalar-Plain">tags</span><span class="p p-Indicator">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">oro_importexport.processor</span>
              <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">import</span>
              <span class="l l-Scalar l-Scalar-Plain">entity</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">AppBundle\Entity\Task</span>
              <span class="l l-Scalar l-Scalar-Plain">alias</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">app_task</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="providing-example-data">
<h2>Providing Example Data<a class="headerlink" href="#providing-example-data" title="Permalink to this headline">¶</a></h2>
<p>To make it easier for your users to understand the format in which they need to enter the data to
be imported, you can provide them with an example file that will be created based on some template
fixtures:</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// src/AppBundle/ImportExport/TemplateFixture;</span>
<span class="k">namespace</span> <span class="nx">AppBundle\ImportExport\TemplateFixture</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">AppBundle\Entity\Task</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Oro\Bundle\ImportExportBundle\TemplateFixture\AbstractTemplateRepository</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Oro\Bundle\ImportExportBundle\TemplateFixture\TemplateFixtureInterface</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">TaskFixture</span> <span class="k">extends</span> <span class="nx">AbstractTemplateRepository</span> <span class="k">implements</span> <span class="nx">TemplateFixtureInterface</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getEntityClass</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="s1">&#39;AppBundle\Entity\Task&#39;</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">getData</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getEntityData</span><span class="p">(</span><span class="s1">&#39;example-task&#39;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">fillEntityData</span><span class="p">(</span><span class="nv">$key</span><span class="p">,</span> <span class="nv">$entity</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$entity</span><span class="o">-&gt;</span><span class="na">setId</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="nv">$entity</span><span class="o">-&gt;</span><span class="na">setSubject</span><span class="p">(</span><span class="s1">&#39;Call customer&#39;</span><span class="p">);</span>
        <span class="nv">$entity</span><span class="o">-&gt;</span><span class="na">setDescription</span><span class="p">(</span><span class="s1">&#39;Please call the customer to talk about their future plans.&#39;</span><span class="p">);</span>
        <span class="nv">$entity</span><span class="o">-&gt;</span><span class="na">setDueDate</span><span class="p">(</span><span class="k">new</span> <span class="nx">\DateTime</span><span class="p">(</span><span class="s1">&#39;+3 days&#39;</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">protected</span> <span class="k">function</span> <span class="nf">createEntity</span><span class="p">(</span><span class="nv">$key</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">Task</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Then, register your fixtures class as a service:</p>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># src/AppBundle/Resources/config/importexport.yml</span>
<span class="l l-Scalar l-Scalar-Plain">services</span><span class="p p-Indicator">:</span>
    <span class="c1"># ...</span>

    <span class="l l-Scalar l-Scalar-Plain">app.importexport.template_fixture.task</span><span class="p p-Indicator">:</span>
        <span class="l l-Scalar l-Scalar-Plain">class</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">AppBundle\ImportExport\TemplateFixture\TaskFixture</span>
        <span class="l l-Scalar l-Scalar-Plain">tags</span><span class="p p-Indicator">:</span>
            <span class="p p-Indicator">-</span> <span class="p p-Indicator">{</span> <span class="nv">name</span><span class="p p-Indicator">:</span> <span class="nv">oro_importexport.template_fixture</span> <span class="p p-Indicator">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="adding-import-and-export-actions-to-the-ui">
<h2>Adding Import and Export Actions to the UI<a class="headerlink" href="#adding-import-and-export-actions-to-the-ui" title="Permalink to this headline">¶</a></h2>
<p>Finally, you need to add control elements to the UI to let your users export existing data and add
new entities by uploading a CSV file. You can include the <code class="docutils literal"><span class="pre">buttons.html.twig</span></code> template from the
OroImportExportBundle while passing it the needed services names (see the configuration above) to
do so:</p>
<div class="highlight-html+jinja"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c">{# src/AppBundle/Resources/views/Task/index.html.twig #}</span>
<span class="cp">{%</span> <span class="k">extends</span> <span class="s1">&#39;OroUIBundle:actions:index.html.twig&#39;</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">set</span> <span class="nv">gridName</span> <span class="o">=</span> <span class="s1">&#39;app-tasks-grid&#39;</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">set</span> <span class="nv">pageTitle</span> <span class="o">=</span> <span class="s1">&#39;Task&#39;</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">navButtons</span> <span class="cp">%}</span>
    <span class="cp">{%</span> <span class="k">include</span> <span class="s1">&#39;OroImportExportBundle:ImportExport:buttons.html.twig&#39;</span> <span class="k">with</span> <span class="o">{</span>
        <span class="nv">entity_class</span><span class="o">:</span> <span class="s1">&#39;AppBundle\\Entity\\Task&#39;</span><span class="o">,</span>
        <span class="nv">exportProcessor</span><span class="o">:</span> <span class="s1">&#39;app_task&#39;</span><span class="o">,</span>
        <span class="nv">exportTitle</span><span class="o">:</span> <span class="s1">&#39;Export&#39;</span><span class="o">,</span>
        <span class="nv">importProcessor</span><span class="o">:</span> <span class="s1">&#39;app_task&#39;</span><span class="o">,</span>
        <span class="nv">importTitle</span><span class="o">:</span> <span class="s1">&#39;Import&#39;</span><span class="o">,</span>
        <span class="nv">datagridName</span><span class="o">:</span> <span class="nv">gridName</span>
    <span class="o">}</span> <span class="cp">%}</span>

    <span class="c">{# ... #}</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


          </div>
        </div>
      </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install_upgrade/index.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../seo_config_guide/index.html">SEO Configuration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../frontstore_guide/index.html">Front Store Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Developer Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../basics/index.html">OroPlatform Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extend_and_customize/index.html">Customizing Oro Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../web_api/index.html">Web Services API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theme/index.html">Customizing the Theme</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install_upgrade_and_patch/index.html">Extension and Patch Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/index.html">Annotation and Configuration Format</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Using and Managing Entities</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="introduction.html">How to Work with Entities</a></li>
<li class="toctree-l3"><a class="reference internal" href="creating_entities.html">How to Create Entities</a></li>
<li class="toctree-l3"><a class="reference internal" href="data_fixtures.html">How to Load Data Fixtures</a></li>
<li class="toctree-l3"><a class="reference internal" href="datagrids.html">How to Create a Basic Datagrid</a></li>
<li class="toctree-l3"><a class="reference internal" href="managing_tasks.html">How to Create and Modify Tasks</a></li>
<li class="toctree-l3"><a class="reference internal" href="deleting_tasks.html">How to Delete Tasks</a></li>
<li class="toctree-l3"><a class="reference internal" href="adding_properties.html">Add Properties to Core Entities</a></li>
<li class="toctree-l3"><a class="reference internal" href="acls.html">How to Protect Entities Using ACLs</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">How to Import and Export Entities</a></li>
<li class="toctree-l3"><a class="reference internal" href="report.html">How to Create a Report</a></li>
<li class="toctree-l3"><a class="reference internal" href="dashboards.html">How to Create a Dashboard Widget</a></li>
<li class="toctree-l3"><a class="reference internal" href="using_entities.html">How to Use Entities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../other/index.html">How to... Articles</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../admin_guide/index.html">Administrator Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configuration_guide/index.html">Configuration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community/index.html">Community Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../system_requirements.html">System Requirements</a></li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Oro Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="../../_sources/dev_guide/entities/import_export.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>