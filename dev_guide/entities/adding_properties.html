<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>How to Add Properties to Core Entities &#8212; OroCommerce 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Customizing CRUD Pages" href="../extend_and_customize/customizing_crud.html" />
    <link rel="prev" title="Customizing Oro Features" href="../extend_and_customize/index.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="how-to-add-properties-to-core-entities">
<h1>How to Add Properties to Core Entities<a class="headerlink" href="#how-to-add-properties-to-core-entities" title="Permalink to this headline">Â¶</a></h1>
<p>OroCommerce, OroCRM and OroPlatform come with a lot of entities that you may have to customize to fit your
application&#8217;s needs. For example, imagine that you want to store the date your contacts became
member of your company&#8217;s partner network.</p>
<p>To achieve this you may want to add a new property <code class="docutils literal"><span class="pre">partnerSince</span></code> which will hold a <code class="docutils literal"><span class="pre">DateTime</span></code>
instance that reflects the date the contact joined your network. This property is added by writing
a migration:</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// src/AppBundle/Migrations/Schema/v1_0/AddPartnerSinceToContact.php</span>
<span class="k">namespace</span> <span class="nx">AppBundle\Migrations\Schema\v1_0</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Doctrine\DBAL\Schema\Schema</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Oro\Bundle\EntityExtendBundle\EntityConfig\ExtendScope</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Oro\Bundle\MigrationBundle\Migration\Migration</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Oro\Bundle\MigrationBundle\Migration\QueryBag</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">AddPartnerSinceToContact</span> <span class="k">implements</span> <span class="nx">Migration</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">up</span><span class="p">(</span><span class="nx">Schema</span> <span class="nv">$schema</span><span class="p">,</span> <span class="nx">QueryBag</span> <span class="nv">$queries</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$table</span> <span class="o">=</span> <span class="nv">$schema</span><span class="o">-&gt;</span><span class="na">getTable</span><span class="p">(</span><span class="s1">&#39;orocrm_contact&#39;</span><span class="p">);</span>
        <span class="nv">$table</span><span class="o">-&gt;</span><span class="na">addColumn</span><span class="p">(</span><span class="s1">&#39;partnerSince&#39;</span><span class="p">,</span> <span class="s1">&#39;datetime&#39;</span><span class="p">,</span> <span class="p">[</span>
            <span class="s1">&#39;oro_options&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
                <span class="s1">&#39;extend&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;owner&#39;</span> <span class="o">=&gt;</span> <span class="nx">ExtendScope</span><span class="o">::</span><span class="na">OWNER_CUSTOM</span><span class="p">],</span>
            <span class="p">],</span>
        <span class="p">]);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Please note that the Entity that you add new property should have <code class="docutils literal"><span class="pre">&#64;Config</span></code> annotation
and should be extended from empty Extend class:</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// src/AppBundle/Entity/Contact.php</span>
<span class="k">namespace</span> <span class="nx">AppBundle\Entity</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Doctrine\ORM\Mapping</span> <span class="k">as</span> <span class="nx">ORM</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Oro\Bundle\EntityConfigBundle\Metadata\Annotation\Config</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">AppBundle\Entity\Model\ExtendContact</span><span class="p">;</span>

<span class="sd">/**</span>
<span class="sd"> * @ORM\Entity()</span>
<span class="sd"> * @Config()</span>
<span class="sd"> */</span>
<span class="k">class</span> <span class="nc">Contact</span> <span class="k">extends</span> <span class="nx">ExtendContact</span>
<span class="p">{</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// src/AppBundle/Model/ExtendContact.php</span>
<span class="k">namespace</span> <span class="nx">AppBundle\Model</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Contact</span> <span class="k">extends</span> <span class="nx">ExtendContact</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * A skeleton method for the getter. You can add it to use autocomplete hints from the IDE.</span>
<span class="sd">     * The real implementation of this method is auto generated.</span>
<span class="sd">     *</span>
<span class="sd">     * @return \DateTime</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getPartnerSince</span><span class="p">()</span>
    <span class="p">{</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * A skeleton method for the setter. You can add it to use autocomplete hints from the IDE.</span>
<span class="sd">     * The real implementation of this method is auto generated.</span>
<span class="sd">     *</span>
<span class="sd">     * @param \DateTime $partnerSince</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getPartnerSince</span><span class="p">(</span><span class="nx">\DateTime</span> <span class="nv">$partnerSince</span><span class="p">)</span>
    <span class="p">{</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>The important part in this migration (which is different to common Doctrine migrations) is the
<code class="docutils literal"><span class="pre">oro_options</span></code> key passed through the <code class="docutils literal"><span class="pre">options</span></code> argument of the <code class="docutils literal"><span class="pre">addColumn()</span></code> method. All
options nested under this key are special to Oro products and will be handled outside of
the usual Doctrine migration workflow.</p>
<p>The <code class="docutils literal"><span class="pre">extend</span></code> key is interpreted by the EntityExtendBundle from the OroPlatform. Using it will
instruct the bundle to generate PHP code in an intermediate class that deals with mapping data for
this attribute to the underlying database and to make it accessible in PHP code. This code is
generated automatically based on the configured data when the application cache is warmed up.</p>
<p>By using the <code class="docutils literal"><span class="pre">ExtendScope::OWNER_CUSTOM</span></code> value the owner attribute tells the OroPlatform that the
property was user defined and that the core system should handle how the property is shown in
grids, forms, and so on if not configured otherwise. It is also possible to set the value of the
owner attribute to <code class="docutils literal"><span class="pre">ExtendScope::OWNER_SYSTEM</span></code>. In this case, nothing will be rendered
automatically, but the developer is responsible to handle this explicitly in code.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../../index.html">Table Of Contents</a></h3>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/dev_guide/entities/adding_properties.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Developer Guide</a><ul>
  <li><a href="../extend_and_customize/index.html">Customizing Oro Features</a><ul>
      <li>Previous: <a href="../extend_and_customize/index.html" title="previous chapter">Customizing Oro Features</a></li>
      <li>Next: <a href="../extend_and_customize/customizing_crud.html" title="next chapter">Customizing CRUD Pages</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Oro Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="../../_sources/dev_guide/entities/adding_properties.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>