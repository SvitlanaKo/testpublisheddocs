<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Forms and Validators Configuration &#8212; OroCommerce 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Headers" href="headers.html" />
    <link rel="prev" title="Documenting API Resources" href="documentation.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
<div class="header">
    <div class="main-nav">
        <nav class="navbar navbar-default navbar-fixed-top">
            <div id="nav-menu" class="navbar-top">
                <div class="nav-container">
                    <div class="navbar-header">
                        <a href="https://www.orocommerce.com/"
                           class="navbar-brand"><img
                                src="https://www.orocommerce.com/wp-content/themes/commerce/images/orocommerce_logo.svg"
                                alt="Open Source B2B eCommerce Platform - OroCommerce"></a>
                    </div>
                    <div class="navbar-header">
                        <p class="navbar-header" href="#">Documentation</p>
                    </div>
                    <div class="navbar-right">
                        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="headers.html" title="Headers"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="documentation.html" title="Documenting API Resources"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">Home</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Developer Guide</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >Web Services API</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="index.html" accesskey="U">API Documentation</a> &#187;</li> 
     <li class="nav-item nav-item-this">Forms and Validators Configuration</li>
      </ul>
    </div>
                    </div>

                </div>
            </div>

        </nav>
    </div>
</div>


      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="forms-and-validators-configuration">
<h1>Forms and Validators Configuration<a class="headerlink" href="#forms-and-validators-configuration" title="Permalink to this headline">¶</a></h1>
<div class="section" id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="#overview">Overview</a></li>
<li><a class="reference external" href="#validation">Validation</a></li>
<li><a class="reference external" href="#forms">Forms</a></li>
</ul>
</div>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The Symfony <a class="reference external" href="http://symfony.com/doc/current/book/validation.html">Validation Component</a> and <a class="reference external" href="http://symfony.com/doc/current/book/forms.html">Forms Component</a> are used to validate and transform input data to an entity in <a class="reference external" href="./actions#create-action">create</a>, <a class="reference external" href="./actions#update-action">update</a>, <a class="reference external" href="./actions#update_relationship-action">update_relationship</a>, <a class="reference external" href="./actions#add_relationship-action">add_relationship</a> and
<a class="reference external" href="./actions#delete_relationship-action">delete_relationship</a> actions.</p>
</div>
<div class="section" id="validation">
<h2>Validation<a class="headerlink" href="#validation" title="Permalink to this headline">¶</a></h2>
<p>The validation rules are loaded from <code class="docutils literal"><span class="pre">Resources/config/validation.yml</span></code> and annotations as it is commonly done in Symfony applications. So, all validation rules defined for an entity are applicable in Data API as well. Also, by default, Data API uses two validation groups: <strong>Default</strong> and <strong>api</strong>. If you need to add validation constrains that should be applicable in Data API only you should add them in <strong>api</strong> validation group.</p>
<p>In case if input data violates some validation constraints, these constraints will be automatically converted to <a class="reference external" href="./processors#error-handling">validation errors</a> which are used to build correct response of Data API. The conversion is performed by <a class="reference external" href="https://github.com/oroinc/platform/tree/master/src/Oro/Bundle/ApiBundle/Processor/Shared/CollectFormErrors.php">CollectFormErrors</a> processor. By default the HTTP status code for validation errors is <code class="docutils literal"><span class="pre">400</span> <span class="pre">Bad</span> <span class="pre">Request</span></code>. But, if needed, there
are several ways to change it:</p>
<ul class="simple">
<li>Implement <a class="reference external" href="https://github.com/oroinc/platform/tree/master/src/Oro/Bundle/ApiBundle/Validator/Constraints/ConstraintWithStatusCodeInterface.php">ConstraintWithStatusCodeInterface</a> in you constraint class.</li>
<li>Implement own constraint text extractor. The API bundle has the <a class="reference external" href="https://github.com/oroinc/platform/tree/master/src/Oro/Bundle/ApiBundle/Request/ConstraintTextExtractor.php">default implementation of constraint text extractor</a>. To add new extractor just create a class implements <a class="reference external" href="https://github.com/oroinc/platform/tree/master/src/Oro/Bundle/ApiBundle/Request/ConstraintTextExtractorInterface.php">ConstraintTextExtractorInterface</a> and tag it with the <code class="docutils literal"><span class="pre">oro.api.constraint_text_extractor</span></code>
in the dependency injection container. Also this service can be used to change an error code and type for a validation constraint.</li>
</ul>
<p>Here are several examples how to add validation constraints to API resources using <code class="docutils literal"><span class="pre">Resources/config/oro/api.yml</span></code> configuration file:</p>
<div class="code yaml highlight-php"><div class="highlight"><pre><span></span><span class="nx">api</span><span class="o">:</span>
    <span class="nx">entities</span><span class="o">:</span>
        <span class="nx">Acme\Bundle\AcmeBundle\Entity\AcmeEntity</span><span class="o">:</span>
            <span class="nx">fields</span><span class="o">:</span>
                <span class="nx">primaryEmail</span><span class="o">:</span>
                    <span class="nx">form_options</span><span class="o">:</span>
                        <span class="nx">constraints</span><span class="o">:</span>
                            <span class="c1"># add Symfony\Component\Validator\Constraints\Email validation constraint</span>
                            <span class="o">-</span> <span class="nx">Email</span><span class="o">:</span> <span class="o">~</span>
                <span class="nx">userName</span><span class="o">:</span>
                    <span class="nx">form_options</span><span class="o">:</span>
                        <span class="nx">constraints</span><span class="o">:</span>
                            <span class="c1"># add Symfony\Component\Validator\Constraints\Length validation constraint</span>
                            <span class="o">-</span> <span class="nx">Length</span><span class="o">:</span>
                                <span class="nb">max</span><span class="o">:</span> <span class="mi">50</span>
                            <span class="c1"># add Acme\Bundle\AcmeBundle\Validator\Constraints\Alphanumeric validation constraint</span>
                            <span class="o">-</span> <span class="nx">Acme\Bundle\AcmeBundle\Validator\Constraints\Alphanumeric</span><span class="o">:</span> <span class="o">~</span>
</pre></div>
</div>
</div>
<div class="section" id="forms">
<h2>Forms<a class="headerlink" href="#forms" title="Permalink to this headline">¶</a></h2>
<p>The Data API forms are isolated from UI forms. It is done to avoid collisions between them and to prevent unnecessary performance overhead in Data API. And as result all Data API form types, extensions and guessers should be registered separately. There are two ways how it can be done:</p>
<ul class="simple">
<li>using application configuration file</li>
<li>tagging form elements by appropriate tag in the dependency injection container</li>
</ul>
<p>To register new form elements using application configuration file you can add <code class="docutils literal"><span class="pre">Resources/config/oro/app.yml</span></code> in any bundle or use <em>app/config/config.yml</em> of your application. The following example shows how it can be done:</p>
<div class="code yaml highlight-php"><div class="highlight"><pre><span></span><span class="nx">api</span><span class="o">:</span>
    <span class="nx">form_types</span><span class="o">:</span>
        <span class="o">-</span> <span class="nx">form</span><span class="o">.</span><span class="nx">type</span><span class="o">.</span><span class="nb">date</span> <span class="c1"># service id of &quot;date&quot; form type</span>
    <span class="nx">form_type_extensions</span><span class="o">:</span>
        <span class="o">-</span> <span class="nx">form</span><span class="o">.</span><span class="nx">type_extension</span><span class="o">.</span><span class="nx">form</span><span class="o">.</span><span class="nx">validator</span> <span class="c1"># service id of Symfony form validation extension</span>
    <span class="nx">form_type_guessers</span><span class="o">:</span>
        <span class="o">-</span> <span class="nx">form</span><span class="o">.</span><span class="nx">type_guesser</span><span class="o">.</span><span class="nx">validator</span> <span class="c1"># service id of Symfony form type guesser based on validation constraints</span>
    <span class="nx">form_type_guesses</span><span class="o">:</span>
        <span class="nx">datetime</span><span class="o">:</span> <span class="c1"># data type</span>
            <span class="nx">form_type</span><span class="o">:</span> <span class="nx">datetime</span> <span class="c1"># the name of guessed form type</span>
            <span class="nx">options</span><span class="o">:</span> <span class="c1"># guessed form type options</span>
                <span class="nx">model_timezone</span><span class="o">:</span> <span class="nx">UTC</span>
                <span class="nx">view_timezone</span><span class="o">:</span> <span class="nx">UTC</span>
                <span class="nx">with_seconds</span><span class="o">:</span> <span class="k">true</span>
                <span class="nx">widget</span><span class="o">:</span> <span class="nx">single_text</span>
                <span class="nx">format</span><span class="o">:</span> <span class="s2">&quot;yyyy-MM-dd&#39;T&#39;HH:mm:ssZZZZZ&quot;</span> <span class="c1"># HTML5</span>
</pre></div>
</div>
<p>Already registered Data API form elements you can find in <a class="reference external" href="https://github.com/oroinc/platform/tree/master/src/Oro/Bundle/ApiBundle/Resources/config/oro/app.yml">Resources/config/oro/app.yml</a>.</p>
<p>Also new form elements can be added using appropriate dependency injection tags. The following table shows all available tags.</p>
<table border="1" class="docutils">
<colgroup>
<col width="41%" />
<col width="59%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Tag</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>oro.api.form.type</td>
<td>Create a new form type</td>
</tr>
<tr class="row-odd"><td>oro.api.form.type_extension</td>
<td>Create a new form extension</td>
</tr>
<tr class="row-even"><td>oro.api.form.type_guesser</td>
<td>Add your own logic for &#8220;form type guessing&#8221;</td>
</tr>
</tbody>
</table>
<p>An example:</p>
<div class="code yaml highlight-php"><div class="highlight"><pre><span></span><span class="nx">acme</span><span class="o">.</span><span class="nx">form</span><span class="o">.</span><span class="nx">type</span><span class="o">.</span><span class="nx">datetime</span><span class="o">:</span>
    <span class="nx">class</span><span class="o">:</span> <span class="nx">Acme\Bundle\AcmeBundle\Form\Type\DateTimeType</span>
    <span class="nx">tags</span><span class="o">:</span>
        <span class="o">-</span> <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="nx">form</span><span class="o">.</span><span class="nx">type</span><span class="p">,</span> <span class="nx">alias</span><span class="o">:</span> <span class="nx">acme_datetime</span> <span class="p">}</span> <span class="c1"># allow to use the form type on UI</span>
        <span class="o">-</span> <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="nx">oro</span><span class="o">.</span><span class="nx">api</span><span class="o">.</span><span class="nx">form</span><span class="o">.</span><span class="nx">type</span><span class="p">,</span> <span class="nx">alias</span><span class="o">:</span> <span class="nx">acme_datetime</span> <span class="p">}</span> <span class="c1"># allow to use the form type in Data API</span>

<span class="nx">acme</span><span class="o">.</span><span class="nx">form</span><span class="o">.</span><span class="nx">extension</span><span class="o">.</span><span class="nx">datetime</span><span class="o">:</span>
    <span class="nx">class</span><span class="o">:</span> <span class="nx">Acme\Bundle\AcmeBundle\Form\Extension\DateTimeExtension</span>
    <span class="nx">tags</span><span class="o">:</span>
        <span class="o">-</span> <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="nx">form</span><span class="o">.</span><span class="nx">type_extension</span><span class="p">,</span> <span class="nx">alias</span><span class="o">:</span> <span class="nx">acme_datetime</span> <span class="p">}</span> <span class="c1"># add the form extension to UI forms</span>
        <span class="o">-</span> <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="nx">oro</span><span class="o">.</span><span class="nx">api</span><span class="o">.</span><span class="nx">form</span><span class="o">.</span><span class="nx">type_extension</span><span class="p">,</span> <span class="nx">alias</span><span class="o">:</span> <span class="nx">acme_datetime</span> <span class="p">}</span> <span class="c1"># add the form extension to Data API forms</span>

<span class="nx">acme</span><span class="o">.</span><span class="nx">form</span><span class="o">.</span><span class="nx">guesser</span><span class="o">.</span><span class="nx">test</span><span class="o">:</span>
    <span class="nx">class</span><span class="o">:</span> <span class="nx">Acme\Bundle\AcmeBundle\Form\Guesser\TestGuesser</span>
    <span class="nx">tags</span><span class="o">:</span>
        <span class="o">-</span> <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="nx">form</span><span class="o">.</span><span class="nx">type_guesser</span> <span class="p">}</span> <span class="c1"># add the form type guesser to UI forms</span>
        <span class="o">-</span> <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="nx">oro</span><span class="o">.</span><span class="nx">api</span><span class="o">.</span><span class="nx">form</span><span class="o">.</span><span class="nx">type_guesser</span> <span class="p">}</span> <span class="c1"># add the form type guesser to Data API forms</span>
</pre></div>
</div>
<p>To switch between general and Data API forms <cite>Processor:raw-latex:</cite>Shared`:raw-latex:<cite>InitializeApiFormExtension</cite> &lt;<a class="reference external" href="https://github.com/oroinc/platform/tree/master/src/Oro/Bundle/ApiBundle/Processor/Shared/InitializeApiFormExtension.php">https://github.com/oroinc/platform/tree/master/src/Oro/Bundle/ApiBundle/Processor/Shared/InitializeApiFormExtension.php</a>&gt;`__ and <cite>Processor:raw-latex:</cite>Shared`:raw-latex:<cite>RestoreDefaultFormExtension</cite> &lt;<a class="reference external" href="https://github.com/oroinc/platform/tree/master/src/Oro/Bundle/ApiBundle/Processor/Shared/RestoreDefaultFormExtension.php">https://github.com/oroinc/platform/tree/master/src/Oro/Bundle/ApiBundle/Processor/Shared/RestoreDefaultFormExtension.php</a>&gt;`__ processors can be used.</p>
<p>A form for a particular entity is built on the fly based on <a class="reference external" href="./configuration.rst">Data API configuration</a> and an entity metadata. It is performed by <cite>Processor:raw-latex:</cite>Shared`:raw-latex:<cite>BuildFormBuilder</cite> &lt;<a class="reference external" href="https://github.com/oroinc/platform/tree/master/src/Oro/Bundle/ApiBundle/Processor/Shared/BuildFormBuilder.php">https://github.com/oroinc/platform/tree/master/src/Oro/Bundle/ApiBundle/Processor/Shared/BuildFormBuilder.php</a>&gt;`__ processor.</p>
</div>
</div>


          </div>
        </div>
      </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../install_upgrade/index.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../user_guide/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../seo_config_guide/index.html">SEO Configuration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../frontstore_guide/index.html">Front Store Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Developer Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../basics/index.html">OroPlatform Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../extend_and_customize/index.html">Customizing Oro Features</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Web Services API</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">API Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../theme/index.html">Customizing the Theme</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../install_upgrade_and_patch/index.html">Extension and Patch Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../reference/index.html">Annotation and Configuration Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../entities/index.html">Using and Managing Entities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../other/index.html">How to... Articles</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../admin_guide/index.html">Administrator Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../configuration_guide/index.html">Configuration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../community/index.html">Community Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../system_requirements.html">System Requirements</a></li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Oro Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="../../../_sources/dev_guide/web_api/api_docs/forms.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>