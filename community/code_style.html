<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Code Style &#8212; OroCommerce 1.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="code-style">
<h1>Code Style<a class="headerlink" href="#code-style" title="Permalink to this headline">¶</a></h1>
<p>Code style is a set of conventions about how to write code. It is introduced for easier understanding of the large codebase by the wide-spread Oro community.</p>
<p>The following code styles are used in all Oro projects, except for projects based on the frameworks, libraries or CMS where other conventions have been adopted.</p>
<div class="section" id="php-code-style">
<h2>PHP Code Style<a class="headerlink" href="#php-code-style" title="Permalink to this headline">¶</a></h2>
<p><strong>Standard</strong></p>
<p>PSR-2 is considered a code standard of the PHP code style.</p>
<p><strong>Default line break separator</strong></p>
<p>Default line break separator is LF (n) - Unix and OS X style.</p>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To eliminate issues with this requirement, it is recommended to configure IDE and always use appropriate line break separator. How to configure this in PHPStorm could be found <a class="reference external" href="https://www.jetbrains.com/help/phpstorm/2016.3/configuring-line-separators.html">here</a></p>
</div>
</div></blockquote>
<p><strong>DocBlock</strong></p>
<p>Use <a class="reference external" href="https://en.wikipedia.org/wiki/PHPDoc">PHPDoc</a> approach to commenting your code.</p>
<p><strong>Class DocBlock</strong></p>
<p>It is <strong>required</strong> to add or update a DocBlock for every class you modify or produce. Include any information that helps clarify non-obvious behavior or conditions.</p>
<p><strong>Method DocBlock</strong></p>
<p>It is <strong>required</strong> to add or update a DocBlock for every method you modify or produce. Include the following information:</p>
<ul>
<li><p class="first">Any information that helps clarify non-obvious behavior or conditions.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Description should briefly reflect the purpose and responsibility of a method. Avoid description that just duplicates the method name.</p>
</div>
</li>
<li><p class="first">The list of parameters, their types and descriptions (&#64;param), and, if the method returns any value, the type and description in the &#64;return annotation.</p>
<blockquote>
<div><p>For example:</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="sd">/**</span>
<span class="sd"> * The method returns status of product inventory.</span>
<span class="sd"> *</span>
<span class="sd"> * Supported values are In Stock, Out of Stock, and Discontinued.</span>
<span class="sd"> *</span>
<span class="sd"> * @param string $SKU The product SKU (unique product id).</span>
<span class="sd"> *</span>
<span class="sd"> * @return string The inventory status of the product found by SKU.</span>
<span class="sd"> *</span>
<span class="sd"> */</span>
</pre></div>
</td></tr></table></div>
</div></blockquote>
</li>
</ul>
<p><strong>Property DocBlock</strong></p>
<p>It is <strong>required</strong> to add or update a DocBlock for every property you produce or use in a new way. Include any information that helps clarify non-obvious behavior, conditions, or possible values.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Description should briefly reflect the property purpose and data type. Avoid description that just duplicates the property name.</p>
</div>
<p><strong>DocBlock Sample</strong></p>
<p>An example of correct DocBlock usage:</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="nx">Oro\Bundle\DataGridBundle\Datasource</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Doctrine\Common\Inflector\Inflector</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Symfony\Component\PropertyAccess\PropertyAccess</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">ResultRecord</span> <span class="k">implements</span> <span class="nx">ResultRecordInterface</span>
<span class="p">{</span>
   <span class="sd">/**</span>
<span class="sd">    * List of containers that are used in some specific way</span>
<span class="sd">    *</span>
<span class="sd">    * @var array</span>
<span class="sd">    */</span>
   <span class="k">private</span> <span class="nv">$valueContainers</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="sd">/**</span>
<span class="sd">     * @var array</span>
<span class="sd">     */</span>
    <span class="k">private</span> <span class="nv">$entities</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="sd">/** @var string */</span>
    <span class="k">private</span> <span class="nv">$value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>

    <span class="sd">/**</span>
<span class="sd">     * @param array $containers</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">(</span><span class="nv">$containers</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * Get value of property by name</span>
<span class="sd">     *</span>
<span class="sd">     * @param  string $name</span>
<span class="sd">     * @return string</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getValue</span><span class="p">(</span><span class="nv">$name</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// ...</span>
        <span class="k">return</span> <span class="nv">$value</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * @return object|null</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">getRootEntity</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// ...</span>
        <span class="k">return</span> <span class="nv">$entity</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><strong>&#64;deprecated usage</strong></p>
<p>Elements that will be removed in future version of the product must be marked as &#64;deprecated.</p>
<p>Comment with deprecation details is <strong>optional</strong>.</p>
<p>The following is an example of &#64;deprecated usage:</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ResultRecord</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">    * @deprecated deprecated since version 2.0</span>
<span class="sd">    */</span>
    <span class="k">private</span> <span class="nv">$valueContainers</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="c1">//....</span>
<span class="p">}</span>


<span class="sd">/**</span>
<span class="sd"> * @deprecated</span>
<span class="sd"> */</span>
<span class="k">class</span> <span class="nc">ResultRecord</span>
<span class="p">{</span>
    <span class="c1">//....</span>
<span class="p">{</span>
</pre></div>
</td></tr></table></div>
<p><strong>&#64;todo usage</strong></p>
<p>&#64;todo should be used for changes that are planned for the future (e.g. <em>The method may be enhanced to handle more granular data validation</em>).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">&#64;todo provide clear description</p>
</div>
<p><strong>Do not import classes from root namespace</strong></p>
<p>Classes from the root namespace should not be imported.</p>
<p>Import internal PHP classes example:</p>
<div class="highlight-php"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// incorrect</span>
<span class="k">use</span> <span class="nx">DateTime</span><span class="p">;</span>
<span class="nv">$date</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DateTime</span><span class="p">();</span>

<span class="c1">// correct</span>
<span class="nv">$date</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\DateTime</span><span class="p">();</span>
</pre></div>
</td></tr></table></div>
<p><strong>PHP code style continuous control</strong></p>
<p>PHP code style is controlled by the  <a class="reference external" href="https://github.com/squizlabs/PHP_CodeSniffer">PHP CodeSniffer tool</a> installed on the continuous integration server according to the rules defined <a class="reference external" href="https://github.com/orocrm/webinar-application/blob/master/ruleset.xml">in the ruleset.xml file</a>.</p>
<p>It is highly recommended for the developers to configure appropriate code style inspections in the IDE or run these inspections manually before merge changes to the master branch to prevent failing of the build that checks code standards.</p>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Information on how to enable PHP CodeSniffer inspection with the custom set of rules in the PHPStorm can be found <a class="reference external" href="https://www.jetbrains.com/help/phpstorm/2016.3/using-php-code-sniffer-tool.html">here, in PHPStorm documentation</a>.</p>
</div>
</div></blockquote>
<p><strong>PHP mess detector</strong></p>
<p>To automatically control code, the quality detector is used, in addition to code style detector tool. <a class="reference external" href="http://phpmd.org/">PHP Mess Detector (PHPMD)</a>, is a tool which can check PHP source code for potential problems. It can detect possible bugs, sub-optimal code, unused parameters, and helps to follow <a class="reference external" href="https://en.wikipedia.org/wiki/SOLID_%28object-oriented_design%29">SOLID</a> principles. In addition to these, PHPMD contains several rules that check for code complexity and can tell if the code could be refactored to improve future maintenance efforts.</p>
<p><strong>Cyclomatic complexity</strong></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">On the Oro projects, cyclomatic complexity MUST NOT exceed the limit of 15.</p>
</div>
<p>Cyclomatic complexity is determined by the number of decision points in a method plus one for the method entry. The decision points are &#8216;if&#8217;, &#8216;while&#8217;, &#8216;for&#8217;, and &#8216;case labels&#8217; (see <a class="reference external" href="https://phpmd.org/rules/codesize.html">PHPMD</a>). The testing strategy is to test each linearly independent path through the program; in this case, the number of test cases will equal the cyclomatic complexity of the program (see <a class="reference external" href="http://users.csc.calpoly.edu/~jdalbey/206/Lectures/BasisPathTutorial/index.html">basis path testing</a>).</p>
<p>There are many good reasons to limit cyclomatic complexity. Overly complex modules are more prone to error, harder to understand, test and modify. Deliberately limiting complexity at all stages of software development, for example as a departmental standard, helps avoid the pitfalls associated with high complexity software. But there were occasional reasons for going beyond the agreed-upon limit. For example, Thomas McCabe originally recommended exempting modules consisting of single multi-way decision (“switch” or “case”) statements from the complexity limit. And suggested the most effective policy: “For each module, either limit cyclomatic complexity to 10 (as discussed earlier, an organization can substitute a similar number), or provide a written explanation of why the limit was exceeded.” (see <a class="reference external" href="http://www.mccabe.com/pdf/mccabe-nist235r.pdf">Structured Testing: A Testing Methodology Using the Cyclomatic Complexity Metric</a>).</p>
<p>Cyclomatic complexity limits suggestions are the following:</p>
<ul class="simple">
<li>PHP: 1-4 is low complexity, 5-7 indicates moderate complexity, 8-10 is high complexity, and 11+ is very high complexity (see <a class="reference external" href="https://phpmd.org/rules/codesize.html">PHPMD</a>).</li>
<li><a class="reference external" href="http://www.javaworld.com/article/2074995/dealing-cyclomatic-complexity-in-java-code.html">Java</a> 1–10 to be considered a Normal application, 11–20 Moderate application, 21–50 Risky application, more than 50 Unstable application (also see <a class="reference external" href="http://gmetrics.sourceforge.net/gmetrics-CyclomaticComplexityMetric.html">here, by GMetrics</a>).</li>
<li>.Net: 1 to 10 a simple program, without very much risk; 11 to 20 a more complex program, moderate risk; 21 to 50 a complex, high risk program; &gt; 50 an un-testable <a class="reference external" href="https://www.codeproject.com/articles/11719/cyclomatic-code-complexity-analysis-for-microsoft">program</a> (very high risk).</li>
<li>Microsoft recommendation is to warn when Cyclomatic complexity is more than 25 (<a class="reference external" href="https://msdn.microsoft.com/en-us/library/ms182212.aspx">CA1502</a>).</li>
<li><a class="reference external" href="http://www.mccabe.com/pdf/mccabe-nist235r.pdf">McCabe</a> originally proposed the limit of 10 since it has significant supporting evidence, but limits as high as 15 have been used successfully as well.</li>
</ul>
<p><strong>NPath complexity</strong></p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">The recommended limit of the NPath complexity is 200 (the default <a class="reference external" href="https://phpmd.org/rules/codesize.html">PHPMD</a> limit).</p>
</div>
<p>The NPath metric computes the number of possible execution paths through a function, meaning how many “paths” there are in the flow of your code in the function. It is similar to the cyclomatic complexity but it also takes into account the nesting of conditional statements and multi-part boolean expressions. So, you should avoid long functions with a lot of (nested) if/else statements.</p>
<p><strong>&#64;SuppressWarnings</strong></p>
<p>It is allowed to use suppress warnings annotations in the following cases ONLY:</p>
<ol class="arabic simple">
<li>&#64;SuppressWarnings(PHPMD) in the code that was automatically generated by a third-party tool or library (example: EwsBundle/Ews).</li>
<li>&#64;SuppressWarnings(PHPMD.ExcessiveMethodLength) for the dataProvider in the PHPUnit tests in the install schema or data migrations.</li>
<li>&#64;SuppressWarnings(PHPMD.TooManyMethods) for the PHPUnit test case classes in the install schema or data migrations.</li>
<li>&#64;SuppressWarnings(PHPMD.CouplingBetweenObjects) in the install schema or data migrations.</li>
<li>&#64;SuppressWarnings(PHPMD.CyclomaticComplexity) for methods consisting of single multi-way decision (“switch” or “case”) statements, when the explanation on why the limit was exceeded is provided in the nearby comment.</li>
<li>all &#64;SuppressWarnings if there are plans to remove these warnings with appropriate &#64;todo comment and ticket.</li>
</ol>
<p>In all other cases, usage of the &#64;SuppressWarnings MUST NOT be used.</p>
<p><strong>php-cs-fixer usage</strong></p>
<p>In order to reduce development time and automate part of the code preparation related to the code style fixes, it is suggested to use <a class="reference external" href="http://cs.sensiolabs.org/">PHP Coding Standard Fixer</a> (or in the <a class="reference external" href="https://github.com/FriendsOfPHP/PHP-CS-Fixer">GitHub repository</a>) - automated tool that fixes most code style issues in the code.</p>
</div>
<div class="section" id="javascript-code-style">
<h2>JavaScript Code Style<a class="headerlink" href="#javascript-code-style" title="Permalink to this headline">¶</a></h2>
<p><strong>Standard</strong></p>
<p><a class="reference external" href="https://google.github.io/styleguide/javascriptguide.xml">Google JavaScript Style Guide</a> is considered as code standard of the JavaScript code style.</p>
<p><strong>JavaScript code style continuous control</strong></p>
<p>In Oro projects, JavaScript code style is controlled by the <a class="reference external" href="http://jscs.info/">JSCS</a> and <a class="reference external" href="http://jshint.com/">JSHint</a> tools configured according to the rules defined in the project repository in <a class="reference external" href="https://github.com/orocrm/platform/blob/master/build/.jshintrc">.jshintrc</a> and <a class="reference external" href="https://github.com/orocrm/platform/blob/master/build/.jscsrc">.jscsrc</a>).</p>
<p>It is highly recommended to configure appropriate code style inspections in the IDE or run these inspections manually before committing the changes and merging it to the project repository.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">JavaScript code style checker in PHPStorm could be enabled in &#8220;Languages &amp; Frameworks&gt;JavaScript&gt;Code Quality Tools&gt;JSCS/JSHint&#8221; and select to use configuration from .jscsrc/.jshintrc accordingly. For JSCS define path to installed node and path to jscs (it is {{your_project_root}}/node_modules/jscs). For JSHint select the version that is defined in package.json (in root folder of project).</p>
</div>
<p>To run the check manually from the command line:</p>
<ul class="simple">
<li>Install required js-modules</li>
</ul>
<div class="highlight-none"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>npm install
</pre></div>
</td></tr></table></div>
<p>(package.json file is added to each dev-repo to root folder)</p>
<ul class="simple">
<li>Execute the following command to run JSCS check:</li>
</ul>
<div class="highlight-none"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>node_modules/.bin/jscs src/*/src/*/Bundle/*Bundle/Resources/public/js/** src/*/src/*/Bundle/*Bundle/Tests/JS/** --config=.jscsrc
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li>Execute the following command to run JSHint check:</li>
</ul>
<div class="highlight-none"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>node_modules/.bin/jshint src/*/src/*/Bundle/*Bundle/Resources/public/js/** src/*/src/*/Bundle/*Bundle/Tests/JS/** --config=.jshintrc
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="net-code-style">
<h2>.NET Code Style<a class="headerlink" href="#net-code-style" title="Permalink to this headline">¶</a></h2>
<p>.NET code MUST follow the Microsoft Managed Recommended Rules. This code style is controlled on the continuous integration with <a class="reference external" href="https://stylecop.codeplex.com/">StyleCop</a>.</p>
</div>
<div class="section" id="css-and-html-code-style">
<h2>CSS and HTML Code Style<a class="headerlink" href="#css-and-html-code-style" title="Permalink to this headline">¶</a></h2>
<p>There are no defined code styles for the CSS and HTML.</p>
<p>It is recommended to use same code style that is used in <a class="reference external" href="http://getbootstrap.com/">Bootstrap</a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../index.html">Table Of Contents</a></h3>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/community/code_style.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Oro Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="../_sources/community/code_style.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>